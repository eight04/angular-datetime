!function(N){"use strict";function e(){if(!(this instanceof e))return new e}N.module("datetime",[]),N.module("datetime").constant("datetimePlaceholder",{year:"(year)",yearShort:"(year)",month:"(month)",date:"(date)",day:"(day)",hour:"(hour)",hour12:"(hour12)",minute:"(minute)",second:"(second)",millisecond:"(millisecond)",ampm:"(AM/PM)",week:"(week)"});var u={exports:{}};!function(e){void 0!==u&&(u.exports=e);var o="listeners",n={on:r,once:i,off:s,emit:a};function t(e){for(var t in n)e[t]=n[t];return e}function r(e,t){return l(this,e).push(t),this}function i(e,t){var n=this;return r.originalListener=t,l(n,e).push(r),n;function r(){s.call(n,e,r),t.apply(this,arguments)}}function s(e,t){var n,r=this;if(arguments.length){if(t){if(n=l(r,e,!0)){if(!(n=n.filter(i)).length)return s.call(r,e);r[o][e]=n}}else if((n=r[o])&&(delete n[e],!Object.keys(n).length))return s.call(r)}else delete r[o];return r;function i(e){return e!==t&&e.originalListener!==t}}function a(e,t){var n=this,r=l(n,e,!0);if(!r)return!1;var i=arguments.length;if(1===i)r.forEach(s);else if(2===i)r.forEach(a);else{var o=Array.prototype.slice.call(arguments,1);r.forEach(u)}return!!r.length;function s(e){e.call(n)}function a(e){e.call(n,t)}function u(e){e.apply(n,o)}}function l(e,t,n){if(!n||e[o]){var r=e[o]||(e[o]={});return r[t]||(r[t]=[])}}t(e.prototype),e.mixin=t}(e);var t=u.exports,A=function(e,t,n){var r;if((e=""+e).length>n)e=e.substr(e.length-n);else if(e.length<t)for(r=e.length;r<t;r++)e="0"+e;return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t};function a(e,t,n){for(var r=0,i=e.toUpperCase(),o=n.toUpperCase();i[t+r]&&i[t+r]==o[r];)r++;return e.substr(t,r)}function l(e,t){var n=(e=e.substring(t)).match(/^\d+/);return n&&n[0]}function h(e,t,n){var r=s(e,t,n);return r.err&&"static"!=t.type&&e.startsWith(t.placeholder,n)&&(1<r.err||r.viewValue.length<=t.placeholder.length)?{empty:!0,viewValue:t.placeholder}:r}function s(e,t,n){var r,i,o,s;if("static"==t.type)return e.startsWith(t.value,n)?{viewValue:t.value}:{err:2,code:"TEXT_MISMATCH",message:"Pattern value mismatch"};if("number"==t.type)return null==(o=l(e,n))?{err:1,code:"NUMBER_MISMATCH",message:"Invalid number",viewValue:""}:o.length<t.minLength?{err:1,code:"NUMBER_TOOSHORT",message:"The length of number is too short",value:+o,viewValue:o,properValue:A(+o,t.minLength,t.maxLength)}:(o.length>t.maxLength&&(o=o.substr(0,t.maxLength)),+o<t.min?{err:1,code:"NUMBER_TOOSMALL",message:"The number is too small",value:+o,viewValue:o,properValue:A(t.min,t.minLength,t.maxLength)}:o.length>t.minLength&&"0"==o[0]?{err:1,code:"LEADING_ZERO",message:"The number has too many leading zero",value:+o,viewValue:o,properValue:A(+o,t.minLength,t.maxLength)}:+o>t.max?{err:1,code:"NUMBER_TOOLARGE",message:"The number is too large",value:+o,viewValue:o,properValue:A(t.max,t.minLength,t.maxLength)}:{value:+o,viewValue:o});if("select"==t.type){for(i="",s=0;s<t.select.length;s++)(r=a(e,n,t.select[s]))&&r.length>i.length&&(o=s,i=r);return i?i!=t.select[o]?{err:1,code:"SELECT_INCOMPLETE",message:"Incomplete select",value:o+1,viewValue:i,selected:t.select[o]}:{value:o+1,viewValue:i}:{err:1,code:"SELECT_MISMATCH",message:"Invalid select",viewValue:""}}throw"Unknown token type: "+t.type}function f(e,t){var n,r,i=0,o=[],s=e,a=Array.isArray(s),u=0;for(s=a?s:s[Symbol.iterator]();;){if(a){if(u>=s.length)break;n=s[u++]}else{if((u=s.next()).done)break;n=u.value}if((r=h(t,n.token,i)).node=n,r.pos=i,r.token=n.token,2<=r.err)throw r.text=t,r;i+=r.viewValue.length,o.push(r)}var l=o[o.length-1];if(l.pos+l.viewValue.length<t.length)throw{code:"TEXT_TOOLONG",message:"Text is too long",text:t};return o}function c(e,t){if("static"==t.type)return{viewValue:t.value};var n=t.extract(e);if("number"==t.type)return{value:n,viewValue:A(n,t.minLength,t.maxLength)};if("select"==t.type)return{value:n,viewValue:t.select[n-1]};throw"Unknown type to format: "+t.type}function p(e,t,n){var r,i,o=[],s=t,a=Array.isArray(s),u=0;for(s=a?s:s[Symbol.iterator]();;){if(a){if(u>=s.length)break;i=s[u++]}else{if((u=s.next()).done)break;i=u.value}r=c(e,i.token),"static"!=i.token.type&&i.empty&&!n&&(r.value=null,r.viewValue=i.token.placeholder),o.push(r)}return o}var d=function(){function n(e,t){O(this,n),this.parser=e,this.token=t,this.value=null,this.viewValue=t.value,this.offset=0,this.next=null,this.prev=null,this.nextEdit=null,this.prevEdit=null,this.empty=!0}return n.prototype.unset=function(){"static"==this.token.type||this.parser.noEmpty||(this.empty=!0,this.parser.setValue(this.parser.value,!1))},n.prototype.parse=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=h(e,this.token,t);if(n.err)throw n.node=this,n.token=this.token,n;if(this.parser.noEmpty&&n.empty)throw{code:"NOT_INIT_FORBIDDEN",message:"Empty node is forbidden",node:this};if(n.empty)this.unset();else{this.empty=!1;var r=g(this.parser.copyValue(this.parser.value),this.token,n.value,this.parser);this.parser.setValue(r,!1)}},n.prototype.add=function(e){var t,n,r,i=this.parser.copyValue(this.parser.value);this.empty=!1,i=m(i,this.token,e,this.parser),t=this.token.extract(i),"number"==this.token.type?(n=this.token.min,r=this.token.max):"select"==this.token.type&&(n=1,r=this.token.select.length),t<n&&(i=g(i,this.token,n,this.parser)),r<t&&(i=g(i,this.token,r,this.parser)),this.parser.setValue(i,!1)},n}();function m(e,t,n,r){return"object"==(void 0===e?"undefined":i(e))?(t.add(e,n,r),e):t.add(e,n,r)}function g(e,t,n,r){return"object"==(void 0===e?"undefined":i(e))?(t.restore(e,n,r),e):t.restore(e,n,r)}function y(e,t){var n,r,i,o=[],s=t,a=Array.isArray(s),u=0;for(s=a?s:s[Symbol.iterator]();;){if(a){if(u>=s.length)break;n=s[u++]}else{if((u=s.next()).done)break;n=u.value}o.push(new d(e,n))}for(r=0;r<o.length;r++)o[r].next=o[r+1]||null,o[r].prev=o[r-1]||null;for(i=null,r=0;r<o.length;r++)o[r].prevEdit=i,"static"!=o[r].token.type&&(i=o[r]);for(i=null,r=o.length-1;0<=r;r--)o[r].nextEdit=i,"static"!=o[r].token.type&&(i=o[r]);return o}function v(e){return e}function x(e){var t=new Map,n=e,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var s=o,a=t.get(s.token.name);a||(a=[],t.set(s.token.name,a)),a.push(s)}return t}var n=function(t){function n(){O(this,n);var e=o(this,t.call(this));return e._constructor.apply(e,arguments),e.initialize(),e}return r(n,t),n.prototype._constructor=function(e){var t=e.tokens,n=e.noEmpty,r=void 0!==n&&n,i=e.value,o=e.text,s=e.copyValue,a=void 0===s?v:s;if(!t||!t.length)throw new Error("option.tokens is required");this.tokens=t,this.nodes=y(this,t),this.nameMap=x(this.nodes),this.value=i,this.text=o,this.noEmpty=r,this.copyValue=a,this.err=!1},n.prototype.initialize=function(){this.setValue(this.value)},n.prototype.parse=function(e){if(!e)throw{code:"EMPTY",message:"The input is empty",oldText:this.text};var t,n;t=f(this.nodes,e);var r,i=[];for(r=this.err?f(this.nodes,this.text):this.nodes,n=0;n<t.length;n++)t[n].empty||t[n].viewValue==r[n].viewValue||(t[n].token=this.nodes[n].token,i.push(t[n]));var o=t.filter(function(e){return e.empty}),s=t.filter(function(e){return e.err});for(n=0;n<t.length;n++)this.nodes[n].value=t[n].value,this.nodes[n].viewValue=t[n].viewValue,this.nodes[n].offset=t[n].pos,this.nodes[n].empty=t[n].empty;if(s.length)throw this.err=!0,s[0];this.err=!1,i.sort(function(e,t){return t.empty?-1:e.empty?1:(t.token.prior||0)-(e.token.prior||0)});var a,u=this.copyValue(this.value),l=i,h=Array.isArray(l),c=0;for(l=h?l:l[Symbol.iterator]();;){if(h){if(c>=l.length)break;a=l[c++]}else{if((c=l.next()).done)break;a=c.value}u=g(u,a.token,a.value,this)}var d=p(u,t).map(function(e){return e.viewValue}).join("");if(e!=d)throw this.err=!0,{code:"INCONSISTENT_INPUT",message:"Successfully parsed but the output text doesn't match the input",text:e,oldText:this.text,properText:d};if(this.text=e,this.value=u,this.emit("change",this.value),o.length)throw{code:"NOT_INIT",message:"Some nodes are empty",text:e,node:o[0]};return this},n.prototype.setValue=function(e){var t,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=p(e,this.nodes,n),i=0,o="";for(t=0;t<r.length;t++)this.nodes[t].value=r[t].value,this.nodes[t].viewValue=r[t].viewValue,this.nodes[t].offset=i,this.nodes[t].empty=!n&&this.nodes[t].empty,i+=this.nodes[t].viewValue.length,o+=this.nodes[t].viewValue;return this.value=e,this.text=o,this.emit("change",this.value),this},n.prototype.isEmpty=function(e){var t,n;if(e)try{t=f(this.nodes,e)}catch(e){return!1}else t=this.nodes;for(n=0;n<t.length;n++)if("static"!=this.nodes[n].token.type&&!t[n].empty)return!1;return!0},n.prototype.isInit=function(){var e,t=this.nodes,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){if(n){if(r>=t.length)break;e=t[r++]}else{if((r=t.next()).done)break;e=r.value}if("static"!=e.token.type&&e.empty)return!1}return!0},n.prototype.unset=function(){var e,t=this.nodes,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){if(n){if(r>=t.length)break;e=t[r++]}else{if((r=t.next()).done)break;e=r.value}e.empty=!0}return this.setValue(this.value,!1),this},n.prototype.getText=function(){return this.text},n.prototype.getValue=function(){return this.value},n.prototype.getNodes=function(e){return e?this.nameMap.get(e):this.nodes},n}(t);function b(e,t){if(t.length){var n=w(t,e).map(function(e){return e.node}),r=n[0],i=n[1];return r==i?r:e-r.offset-r.viewValue.length<=i.offset-e?r:i}}function w(e,t){var n,r,i,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t,s=e,a=Array.isArray(s),u=0;for(s=a?s:s[Symbol.iterator]();;){if(a){if(u>=s.length)break;n=s[u++]}else{if((u=s.next()).done)break;n=u.value}n.offset<=t&&(r={node:n,pos:t-n.offset}),n.offset+n.viewValue.length>=o&&!i&&(i={node:n,pos:o-n.offset})}if(!i){var l=e[e.length-1];i={node:l,pos:l.viewValue.length}}r||(r={node:e[0],pos:0});return r.pos>r.node.viewValue.length&&(r.pos=r.node.viewValue.length),[r,i]}var T=function(){function n(e,t){O(this,n),this.el=e,this.nodes=t,this.range={node:b(0,this.nodes),start:0,end:"end"}}return n.prototype.selectNearestNode=function(){var e=this.el.getSelection();e&&this.select({node:b(e.start,this.nodes),start:0,end:"end"})},n.prototype.select=function(e){(e=Object.assign(this.range,e)).node&&this.el.setSelection(e.node.offset+e.start,e.node.offset+("end"==e.end?e.node.viewValue.length:e.end))},n.prototype.hasNext=function(){if(this.range.node)return this.range.node.nextEdit},n.prototype.hasPrev=function(){if(this.range.node)return this.range.node.prevEdit},n.prototype.selectNext=function(){var e=this.hasNext(),t={start:0,end:"end"};e&&(t.node=e),this.select(t)},n.prototype.selectPrev=function(){var e=this.hasPrev(),t={start:0,end:"end"};e&&(t.node=e),this.select(t)},n.prototype.get=function(){if(this.nodes.length){var e=this.el.getSelection();if(e){var t=w(this.nodes,e.start,e.end),n=t[0],r=t[1];n.node==r.node&&(this.range={node:n.node,start:n.pos,end:r.pos})}}},n.prototype.atNodeEnd=function(){if(this.range.node){this.get();var e=this.range.node.viewValue.length,t=this.range.node.token.maxLength,n="end"==this.range.start?e:this.range.start;return n==("end"==this.range.end?e:this.range.end)&&n==(null!=t?t:e)||!e}},n.prototype.atNodeStart=function(){if(this.range.node){this.get();var e=this.range.node.viewValue.length,t="end"==this.range.start?e:this.range.start;return t==("end"==this.range.end?e:this.range.end)&&0==t}},n}(),k=function(t){function n(){O(this,n);var e=o(this,t.call(this));return e._constructor.apply(e,arguments),e.initialize(),e}return r(n,t),n.prototype._constructor=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";this.el=e,this.tp=t,this.separators=n,this.sel=new T(e,t.getNodes().filter(function(e){return"static"!=e.token.type}))},n.prototype.initialize=function(){var o=this;this.el.on("mousedown",function(){o.mousedown=!0}),this.el.on("focus",function(){o.mousedown||setTimeout(function(){o.sel.select({start:0,end:"end"})})}),this.el.on("click",function(){o.mousedown=!1,o.sel.selectNearestNode()}),this.el.on("input",function(){o.digest(null,o.el.val())}),this.el.on("keydown",function(e){e.altKey||e.ctrlKey||(37==e.keyCode||9==e.keyCode&&e.shiftKey&&o.sel.hasPrev()?(e.preventDefault(),o.tryFixingError(),o.sel.selectPrev()):39==e.keyCode||9==e.keyCode&&!e.shiftKey&&o.sel.hasNext()?(e.preventDefault(),o.tryFixingError(),o.sel.selectNext()):38==e.keyCode?(e.preventDefault(),o.sel.selectNearestNode(),o.sel.range.node&&o.sel.range.node.add(1),o.val(o.tp.getText()),o.sel.select({start:0,end:"end"})):40==e.keyCode?(e.preventDefault(),o.sel.selectNearestNode(),o.sel.range.node&&o.sel.range.node.add(-1),o.val(o.tp.getText()),o.sel.select({start:0,end:"end"})):36==e.keyCode||35==e.keyCode?setTimeout(function(){return o.sel.selectNearestNode()}):46==e.keyCode?o.sel.atNodeEnd()&&(e.preventDefault(),o.tryFixingError(),o.sel.selectNext()):8==e.keyCode&&o.sel.atNodeStart()&&(e.preventDefault(),o.tryFixingError(),o.sel.selectPrev()))}),this.el.on("keypress",function(e){var t=null==e.charCode?e.keyCode:e.charCode,n=String.fromCharCode(t),r=o.separators,i=o.sel.range.node;if(i&&i.next&&"static"==i.next.token.type&&(r+=i.next.viewValue[0]),r.includes(n))return e.preventDefault(),o.tryFixingError(),void o.sel.selectNext();setTimeout(function(){o.sel.atNodeEnd()&&o.sel.range.node.viewValue&&(o.tryFixingError(),o.sel.selectNext())})}),this.el.on("blur",function(){setTimeout(function(){o.tryFixingError()})}),this.tp.on("change",function(){o.err||o.inDigest||(o.val(o.tp.getText()),o.sel.select())});var e=this.el.val();e?this.digest(null,e,!0):this.val(this.tp.getText())},n.prototype.errorViewLength=function(){if(this.err&&null!=this.err.viewValue)return this.err.viewValue.length},n.prototype.val=function(e){this.el.val()!=e&&this.el.val(e),this.err=null},n.prototype.tryFixingError=function(){this.err&&(this.err.properValue?this.digest(this.err.node,this.err.properValue,!0):this.err.node&&(this.err.node.unset(),this.digest(null,this.tp.getText())))},n.prototype.digest=function(t,n,r){var i,e=10;for(this.inDigest=!0;e--;){this.err=null;try{t?t.parse(n):this.tp.parse(n)}catch(e){if(this.emit("digest",e),this.sel.get(),"NOT_INIT"==e.code)break;if(this.err=e,!r&&("NUMBER_TOOSHORT"==e.code||"NUMBER_TOOSMALL"==e.code||"NUMBER_MISMATCH"==e.code||"SELECT_MISMATCH"==e.code||"LEADING_ZERO"==e.code))break;if("SELECT_INCOMPLETE"==e.code){t=e.node,n=e.selected,i={end:"end"};continue}null!=e.properValue?(t=e.node,n=e.properValue):null!=e.properText?(t=null,n=e.properText):("EMPTY"==e.code&&this.tp.unset(),e.node&&e.node.unset(),t=null,n=this.tp.getText(),i={start:0,end:"end"});continue}break}if(this.err||(this.val(this.tp.getText()),e<9&&this.sel.select(i)),this.inDigest=!1,e<0)throw new Error("InputMask.digest crashed! Infinite loop on "+n)},n}(t),$=n,E=k;function V(e,t){var l=e.DATETIME_FORMATS,o=/yyyy|yy|y|M{1,4}|dd?|EEEE?|HH?|hh?|mm?|ss?|([.,])sss|a|Z{1,2}|ww|w|'(([^']+|'')*)'/g,s={y:{minLength:1,maxLength:4,max:9999,min:0,name:"year",type:"number"},yy:{minLength:2,maxLength:2,name:"yearShort",type:"number"},yyyy:{minLength:4,maxLength:4,max:9999,min:0,name:"year",type:"number"},MMMM:{name:"month",type:"select",select:l.MONTH},MMM:{name:"month",type:"select",select:l.SHORTMONTH},MM:{minLength:2,maxLength:2,name:"month",type:"number"},M:{minLength:1,maxLength:2,name:"month",type:"number",min:1},dd:{minLength:2,maxLength:2,name:"date",type:"number"},d:{minLength:1,maxLength:2,name:"date",type:"number",min:1},EEEE:{name:"day",type:"select",select:v(l.DAY)},EEE:{name:"day",type:"select",select:v(l.SHORTDAY)},HH:{minLength:2,maxLength:2,name:"hour",type:"number"},H:{minLength:1,maxLength:2,name:"hour",type:"number"},hh:{minLength:2,maxLength:2,name:"hour12",type:"number"},h:{minLength:1,maxLength:2,name:"hour12",type:"number"},mm:{minLength:2,maxLength:2,name:"minute",type:"number"},m:{minLength:1,maxLength:2,name:"minute",type:"number"},ss:{minLength:2,maxLength:2,name:"second",type:"number"},s:{minLength:1,maxLength:2,name:"second",type:"number"},sss:{minLength:3,maxLength:3,name:"millisecond",type:"number"},a:{name:"ampm",type:"select",select:l.AMPMS},ww:{minLength:2,maxLength:2,max:53,name:"week",type:"number"},w:{minLength:1,maxLength:2,max:53,name:"week",type:"number"},Z:{name:"timezone",type:"static"},ZZ:{name:"timezone",type:"static",colon:!0},string:{name:"string",type:"static"}},n={year:{extract:function(e){var t=e.getFullYear()%1e4;return 0<=t?t:0},restore:function(e,t){return e.setFullYear(t)},add:function(e,t){return e.setFullYear(e.getFullYear()+t)},prior:7},yearShort:{extract:function(e){var t=e.getFullYear()%100;return 0<=t?t:t+100},restore:function(e,t){return e.setFullYear(t)},add:function(e,t){return e.setFullYear(e.getFullYear()+t)},prior:7},month:{extract:function(e){return e.getMonth()+1},restore:function(e,t){e.setMonth(t-1),e.getMonth()==t&&e.setDate(0)},add:function(e,t){t=e.getMonth()+t,e.setMonth(t),e.getMonth()==t+1&&e.setDate(0)},prior:5},date:{extract:function(e){return e.getDate()},restore:function(e,t,n){var r=e.getMonth();if(e.setDate(t),e.getMonth()!=r&&t<=31){var i=n.getNodes("month");i&&i.every(function(e){return e.empty})&&e.setDate(t)}},add:function(e,t,n){this.restore(e,e.getDate()+t,n)},prior:4},day:{extract:function(e){return e.getDay()||7},restore:w,add:function(e,t){return e.setDate(e.getDate()+t)},prior:4},hour:{extract:function(e){return e.getHours()},restore:function(e,t){return e.setHours(t)},add:function(e,t){return e.setHours(e.getHours()+t)},prior:2},hour12:{extract:function(e){return e.getHours()%12||12},restore:T,add:function(e,t){return e.setHours(e.getHours()+t)},prior:2},ampm:{extract:function(e){return e.getHours()<12?1:2},restore:k,add:function(e,t){return e.setHours(e.getHours()+12*t)},prior:3},minute:{extract:function(e){return e.getMinutes()},restore:function(e,t){return e.setMinutes(t)},add:function(e,t){return e.setMinutes(e.getMinutes()+t)},prior:0},second:{extract:function(e){return e.getSeconds()},restore:function(e,t){return e.setSeconds(t)},add:function(e,t){return e.setSeconds(e.getSeconds()+t)},prior:1},millisecond:{extract:function(e){return e.getMilliseconds()},restore:function(e,t){return e.setMilliseconds(t)},add:function(e,t){return e.setMilliseconds(e.getMilliseconds()+t)},prior:1},week:{extract:b,restore:function(e,t){return e.setDate(e.getDate()+7*(t-b(e)))},add:function(e,t){return e.setDate(e.getDate()+7*t)},prior:6}};for(var r in n)n[r].placeholder=t[r];var i=Object.values(s),a=Array.isArray(i),u=0;for(i=a?i:i[Symbol.iterator]();;){var h;if(a){if(u>=i.length)break;h=i[u++]}else{if((u=i.next()).done)break;h=u.value}var c=h;n[c.name]&&N.extend(c,n[c.name])}var d,f,p,m,g,y=(d=-(new Date).getTimezoneOffset(),f=0<=d?"+":"-",p=Math.abs(d),m=Math.floor(p/60),g=p%60,f+A(m,2,2)+A(g,2,2));function v(e){var t,n=[];for(t=1;t<e.length;t++)n.push(e[t]);return n.push(e[0]),n}function x(e){for(var t,n=[],r=0;t=o.exec(e);)if(t.index>r&&(n.push(N.extend({value:e.substring(r,t.index)},s.string)),r=t.index),t.index==r){if(t[1])n.push(N.extend({value:t[1]},s.string)),n.push(s.sss);else if(t[2])n.push(N.extend({value:t[2].replace("''","'")},s.string));else if("timezone"==s[t[0]].name){var i=y;s[t[0]].colon&&(i=E(i)),n.push(N.extend({value:i},s[t[0]]))}else n.push(s[t[0]]);r=o.lastIndex}return r<e.length&&n.push(N.extend({value:e.substring(r)},s.string)),n}function b(e){var t=new Date(e.getFullYear(),0,1),n=new Date(t.getTime());4<n.getDay()?n.setDate(n.getDate()+(1-n.getDay())+7):n.setDate(n.getDate()+(1-n.getDay()));var r=e.getTime()-n.getTime();return Math.floor(r/6048e5)}function w(e,t){var n=e.getMonth(),r=t-(e.getDay()||7);e.setDate(e.getDate()+r),e.getMonth()!=n&&(0<r?e.setDate(e.getDate()-7):e.setDate(e.getDate()+7))}function T(e,t){t%=12,12<=e.getHours()&&(t+=12),e.setHours(t)}function k(e,t){var n=e.getHours();n<12==1<t&&e.setHours((n+12)%24)}function E(e){return":"==e[3]?e:e.substr(0,3)+":"+e.substr(3,2)}function V(e){return":"!=e[3]?e:e.substr(0,3)+e.substr(4,2)}function D(e,t){var n=(60*+(t=V(t)).substr(1,2)+ +t.substr(3,2))*(t[0]+"1");return new Date(e.getTime()+60*(n- -e.getTimezoneOffset())*1e3)}function M(e,t){var n=(60*+(t=V(t)).substr(1,2)+ +t.substr(3,2))*(t[0]+"1");return new Date(e.getTime()+60*(-e.getTimezoneOffset()-n)*1e3)}var L=function(){function t(e){O(this,t),this.tp=e,this.timezone=y,this.timezoneNodes=this.tp.nodes.filter(function(e){return"timezone"==e.token.name})}return t.prototype.parse=function(e){return this.tp.parse(e),this},t.prototype.getText=function(){return this.tp.getText()},t.prototype.setDate=function(e,t){return this.tp.setValue(D(e,this.timezone),t),this},t.prototype.getDate=function(){return M(this.tp.getValue(),this.timezone)},t.prototype.setTimezone=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:y;if(e!=this.timezone){var t=this.getDate();this.timezone=e;var n=this.timezoneNodes,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var s=o;s.token.colon?s.token.value=E(e):s.token.value=V(e)}return this.setDate(t,!1)}},t.prototype.isEmpty=function(){return this.tp.isEmpty.apply(this.tp,arguments)},t.prototype.isInit=function(){return this.tp.isInit.apply(this.tp,arguments)},t.prototype.unset=function(){return this.tp.unset(),this},t}();function S(e){var t,n=x(l[e]||e);t=n.some(function(e){return"yearShort"==e.name})?function(n){return function(e){n.apply(this,arguments);var t=e.getFullYear();t<0&&e.setFullYear(t+100)}}:function(n){return function(e){n.apply(this,arguments);var t=e.getFullYear();t<0&&e.setFullYear(0),9999<t&&e.setFullYear(9999)}};var r=n,i=Array.isArray(r),o=0;for(r=i?r:r[Symbol.iterator]();;){var s;if(i){if(o>=r.length)break;s=r[o++]}else{if((o=r.next()).done)break;s=o.value}var a=s;a.add&&(a.add=t(a.add)),a.restore&&(a.restore=t(a.restore))}var u=new $({tokens:n,value:new Date,copyValue:function(e){return new Date(e.getTime())}});return new L(u)}return S}function D(m,e,g){var y=function(){function n(e,t){O(this,n),this.el=e,this.doc=t}return n.prototype.on=function(e,t){if("input"!=e)return this.el.on(e,t)},n.prototype.getSelection=function(){var e=this.el[0];if(this.doc.activeElement==e){var t=e.selectionStart,n=e.selectionEnd;return N.isDefined(t)&&N.isDefined(n)?{start:t,end:n}:this.getSelectionIE()}},n.prototype.getSelectionIE=function(){var e=this.el[0],t=this.doc.selection.createRange().getBookmark(),n=e.createTextRange(),r=n.duplicate();n.moveToBookmark(t),r.setEndPoint("EndToStart",n);var i=r.text.length;return{start:i,end:i+n.text.length}},n.prototype.setSelection=function(e,t){var n=this.el[0];this.doc.activeElement==n&&(n.setSelectionRange?n.setSelectionRange(e,t):this.setSelectionIE(e,t))},n.prototype.setSelectionIE=function(e,t){var n=this.el[0].createTextRange();n.moveStart("character",e),n.collapse(),n.moveEnd("character",t-e),n.select()},n.prototype.val=function(){var e;return(e=this.el).val.apply(e,arguments)},n}();function t(t,e,n,r){if(!r)return!1;n.ngTrim="false";var i,o=m(n.datetime),s=n.datetimeModel&&m(n.datetimeModel),a=new y(e,g[0]),u=new E(a,o.tp,n.datetimeSeparator);function l(e){e&&!i?(i=!0,o.setTimezone("+0000"),s&&s.setTimezone("+0000")):!e&&i&&(i=!1,o.setTimezone(),s&&s.setTimezone())}function h(e){o.setTimezone(e),s&&s.setTimezone(e)}function c(e){return!(!r.$isEmpty(e)&&!r.$isEmpty(n.min))||(N.isDate(e)||(e=s.getDate()),e>=new Date(n.min))}function d(e){return!(!r.$isEmpty(e)&&!r.$isEmpty(n.max))||(N.isDate(e)||(e=s.getDate()),e<=new Date(n.max))}function f(e){return r.$validate?r.$validate():(r.$setValidity("min",c(e)),r.$setValidity("max",d(e))),!r.$error.min&&!r.$error.max}function p(e){return!(!N.isDate(e)||s)||!(!N.isString(e)||!s)}u.on("digest",function(e){"NOT_INIT"!=e.code&&r.$setValidity("datetime",!1)}),o.tp.on("change",function(){t.$evalAsync(function(){u.err?r.$setValidity("datetime",!1):(o.isInit()||o.isEmpty()?r.$setValidity("datetime",!0):r.$setValidity("datetime",!1),o.getText()!=r.$viewValue&&r.$setViewValue(o.getText()))})}),N.isDefined(n.datetimeUtc)&&(0<n.datetimeUtc.length?t.$watch(n.datetimeUtc,l):l(!0)),N.isDefined(n.datetimeTimezone)&&(/^[+-]\d{2}:?\d{2}$/.test(n.datetimeTimezone)?h(n.datetimeTimezone):t.$watch(n.datetimeTimezone,h)),r.$validators&&(r.$validators.min=c,r.$validators.max=d),n.$observe("min",function(){f(o.getDate())}),n.$observe("max",function(){f(o.getDate())}),r.$render=function(){},r.$isEmpty=function(e){return!e||"string"==typeof e&&o.isEmpty(e)},r.$parsers.unshift(function(e){if(N.isUndefined(e)&&(e=o.getText()),!N.isString(e))return e;if(u.digest(null,e),o.isInit()){var t=o.getDate();return r.$validate||f(t)?s?s.setDate(t).getText():new Date(t.getTime()):void 0}}),r.$formatters.push(function(e){return r.$setValidity("datetime",!0),e?p(e)?(s&&(e=s.parse(e).getDate()),r.$validate||f(e),o.setDate(e).getText()):e:(o.unset(),t.$evalAsync(function(){r.$setViewValue(o.getText())}),o.getText())})}return{restrict:"A",require:"?ngModel",link:t,priority:100}}N.module("datetime").factory("datetime",V),V.$inject=["$locale","datetimePlaceholder"],N.module("datetime").directive("datetime",D),D.$inject=["datetime","$log","$document"]}(angular);

{"version":3,"file":"datetime.js","sources":["../lib/main.js","../node_modules/event-lite/event-lite.js","../node_modules/custom-input/lib/utils.js","../node_modules/custom-input/lib/text-parser.js","../node_modules/custom-input/lib/input-mask.js","../node_modules/custom-input/index.js","../lib/factory.js","../lib/directive.js"],"sourcesContent":["var angular = require(\"angular\");\r\n\r\nangular.module(\"datetime\", []);\r\n\r\nangular.module(\"datetime\").constant(\"datetimePlaceholder\", {\r\n\tyear: \"(year)\",\r\n\tyearShort: \"(year)\",\r\n\tmonth: \"(month)\",\r\n\tdate: \"(date)\",\r\n\tday: \"(day)\",\r\n\thour: \"(hour)\",\r\n\thour12: \"(hour12)\",\r\n\tminute: \"(minute)\",\r\n\tsecond: \"(second)\",\r\n\tmillisecond: \"(millisecond)\",\r\n\tampm: \"(AM/PM)\",\r\n\tweek: \"(week)\"\r\n});\r\n","/**\n * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)\n *\n * @copyright Yusuke Kawasaki\n * @license MIT\n * @constructor\n * @see https://github.com/kawanet/event-lite\n * @see http://kawanet.github.io/event-lite/EventLite.html\n * @example\n * var EventLite = require(\"event-lite\");\n *\n * function MyClass() {...}             // your class\n *\n * EventLite.mixin(MyClass.prototype);  // import event methods\n *\n * var obj = new MyClass();\n * obj.on(\"foo\", function() {...});     // add event listener\n * obj.once(\"bar\", function() {...});   // add one-time event listener\n * obj.emit(\"foo\");                     // dispatch event\n * obj.emit(\"bar\");                     // dispatch another event\n * obj.off(\"foo\");                      // remove event listener\n */\n\nfunction EventLite() {\n  if (!(this instanceof EventLite)) return new EventLite();\n}\n\n(function(EventLite) {\n  // export the class for node.js\n  if (\"undefined\" !== typeof module) module.exports = EventLite;\n\n  // property name to hold listeners\n  var LISTENERS = \"listeners\";\n\n  // methods to export\n  var methods = {\n    on: on,\n    once: once,\n    off: off,\n    emit: emit\n  };\n\n  // mixin to self\n  mixin(EventLite.prototype);\n\n  // export mixin function\n  EventLite.mixin = mixin;\n\n  /**\n   * Import on(), once(), off() and emit() methods into target object.\n   *\n   * @function EventLite.mixin\n   * @param target {Prototype}\n   */\n\n  function mixin(target) {\n    for (var key in methods) {\n      target[key] = methods[key];\n    }\n    return target;\n  }\n\n  /**\n   * Add an event listener.\n   *\n   * @function EventLite.prototype.on\n   * @param type {string}\n   * @param func {Function}\n   * @returns {EventLite} Self for method chaining\n   */\n\n  function on(type, func) {\n    getListeners(this, type).push(func);\n    return this;\n  }\n\n  /**\n   * Add one-time event listener.\n   *\n   * @function EventLite.prototype.once\n   * @param type {string}\n   * @param func {Function}\n   * @returns {EventLite} Self for method chaining\n   */\n\n  function once(type, func) {\n    var that = this;\n    wrap.originalListener = func;\n    getListeners(that, type).push(wrap);\n    return that;\n\n    function wrap() {\n      off.call(that, type, wrap);\n      func.apply(this, arguments);\n    }\n  }\n\n  /**\n   * Remove an event listener.\n   *\n   * @function EventLite.prototype.off\n   * @param [type] {string}\n   * @param [func] {Function}\n   * @returns {EventLite} Self for method chaining\n   */\n\n  function off(type, func) {\n    var that = this;\n    var listners;\n    if (!arguments.length) {\n      delete that[LISTENERS];\n    } else if (!func) {\n      listners = that[LISTENERS];\n      if (listners) {\n        delete listners[type];\n        if (!Object.keys(listners).length) return off.call(that);\n      }\n    } else {\n      listners = getListeners(that, type, true);\n      if (listners) {\n        listners = listners.filter(ne);\n        if (!listners.length) return off.call(that, type);\n        that[LISTENERS][type] = listners;\n      }\n    }\n    return that;\n\n    function ne(test) {\n      return test !== func && test.originalListener !== func;\n    }\n  }\n\n  /**\n   * Dispatch (trigger) an event.\n   *\n   * @function EventLite.prototype.emit\n   * @param type {string}\n   * @param [value] {*}\n   * @returns {boolean} True when a listener received the event\n   */\n\n  function emit(type, value) {\n    var that = this;\n    var listeners = getListeners(that, type, true);\n    if (!listeners) return false;\n    var arglen = arguments.length;\n    if (arglen === 1) {\n      listeners.forEach(zeroarg);\n    } else if (arglen === 2) {\n      listeners.forEach(onearg);\n    } else {\n      var args = Array.prototype.slice.call(arguments, 1);\n      listeners.forEach(moreargs);\n    }\n    return !!listeners.length;\n\n    function zeroarg(func) {\n      func.call(that);\n    }\n\n    function onearg(func) {\n      func.call(that, value);\n    }\n\n    function moreargs(func) {\n      func.apply(that, args);\n    }\n  }\n\n  /**\n   * @ignore\n   */\n\n  function getListeners(that, type, readonly) {\n    if (readonly && !that[LISTENERS]) return;\n    var listeners = that[LISTENERS] || (that[LISTENERS] = {});\n    return listeners[type] || (listeners[type] = []);\n  }\n\n})(EventLite);\n","module.exports = {\r\n\tnum2str(num, minLength, maxLength) {\r\n\t\tvar i;\r\n\t\tnum = \"\" + num;\r\n\t\tif (num.length > maxLength) {\r\n\t\t\tnum = num.substr(num.length - maxLength);\r\n\t\t} else if (num.length < minLength) {\r\n\t\t\tfor (i = num.length; i < minLength; i++) {\r\n\t\t\t\tnum = \"0\" + num;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn num;\r\n\t},\r\n\tEmitter: require(\"event-lite\")\r\n};\r\n","var { num2str, Emitter } = require(\"./utils\");\r\n\r\nfunction getMatch(str, pos, pattern) {\r\n\tvar i = 0,\r\n\t\tstrQ = str.toUpperCase(),\r\n\t\tpatternQ = pattern.toUpperCase();\r\n\r\n\twhile (strQ[pos + i] && strQ[pos + i] == patternQ[i]) {\r\n\t\ti++;\r\n\t}\r\n\r\n\treturn str.substr(pos, i);\r\n}\r\n\r\nfunction getInteger(str, pos) {\r\n\tstr = str.substring(pos);\r\n\tvar match = str.match(/^\\d+/);\r\n\treturn match && match[0];\r\n}\r\n\r\nfunction parseNode(text, token, pos) {\r\n\tvar result = parseToken(text, token, pos);\r\n\t\r\n\t// check placeholder\r\n\tif (\r\n\t\tresult.err &&\r\n\t\ttoken.type != \"static\" && text.startsWith(token.placeholder, pos) &&\r\n\t\t(result.err > 1 || result.viewValue.length <= token.placeholder.length)\r\n\t) {\r\n\t\treturn {\r\n\t\t\tempty: true,\r\n\t\t\tviewValue: token.placeholder\r\n\t\t};\r\n\t}\r\n\t\r\n\treturn result;\r\n}\r\n\r\nfunction parseToken(text, token, pos) {\r\n\tvar m, match, value, j;\r\n\r\n\tif (token.type == \"static\") {\r\n\t\tif (!text.startsWith(token.value, pos)) {\r\n\t\t\treturn {\r\n\t\t\t\terr: 2,\r\n\t\t\t\tcode: \"TEXT_MISMATCH\",\r\n\t\t\t\tmessage: \"Pattern value mismatch\"\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tviewValue: token.value\r\n\t\t};\r\n\t}\r\n\r\n\tif (token.type == \"number\") {\r\n\t\tvalue = getInteger(text, pos);\r\n\r\n\t\tif (value == null) {\r\n\t\t\treturn {\r\n\t\t\t\terr: 1,\r\n\t\t\t\tcode: \"NUMBER_MISMATCH\",\r\n\t\t\t\tmessage: \"Invalid number\",\r\n\t\t\t\tviewValue: \"\"\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (value.length < token.minLength) {\r\n\t\t\treturn {\r\n\t\t\t\terr: 1,\r\n\t\t\t\tcode: \"NUMBER_TOOSHORT\",\r\n\t\t\t\tmessage: \"The length of number is too short\",\r\n\t\t\t\tvalue: +value,\r\n\t\t\t\tviewValue: value,\r\n\t\t\t\tproperValue: num2str(+value, token.minLength, token.maxLength)\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (value.length > token.maxLength) {\r\n\t\t\tvalue = value.substr(0, token.maxLength);\r\n\t\t}\r\n\r\n\t\tif (+value < token.min) {\r\n\t\t\treturn {\r\n\t\t\t\terr: 1,\r\n\t\t\t\tcode: \"NUMBER_TOOSMALL\",\r\n\t\t\t\tmessage: \"The number is too small\",\r\n\t\t\t\tvalue: +value,\r\n\t\t\t\tviewValue: value,\r\n\t\t\t\tproperValue: num2str(token.min, token.minLength, token.maxLength)\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (value.length > token.minLength && value[0] == \"0\") {\r\n\t\t\treturn {\r\n\t\t\t\terr: 1,\r\n\t\t\t\tcode: \"LEADING_ZERO\",\r\n\t\t\t\tmessage: \"The number has too many leading zero\",\r\n\t\t\t\tvalue: +value,\r\n\t\t\t\tviewValue: value,\r\n\t\t\t\tproperValue: num2str(+value, token.minLength, token.maxLength)\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (+value > token.max) {\r\n\t\t\treturn {\r\n\t\t\t\terr: 1,\r\n\t\t\t\tcode: \"NUMBER_TOOLARGE\",\r\n\t\t\t\tmessage: \"The number is too large\",\r\n\t\t\t\tvalue: +value,\r\n\t\t\t\tviewValue: value,\r\n\t\t\t\tproperValue: num2str(token.max, token.minLength, token.maxLength)\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tvalue: +value,\r\n\t\t\tviewValue: value\r\n\t\t};\r\n\t}\r\n\r\n\tif (token.type == \"select\") {\r\n\t\tmatch = \"\";\r\n\t\tfor (j = 0; j < token.select.length; j++) {\r\n\t\t\tm = getMatch(text, pos, token.select[j]);\r\n\t\t\tif (m && m.length > match.length) {\r\n\t\t\t\tvalue = j;\r\n\t\t\t\tmatch = m;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!match) {\r\n\t\t\treturn {\r\n\t\t\t\terr: 1,\r\n\t\t\t\tcode: \"SELECT_MISMATCH\",\r\n\t\t\t\tmessage: \"Invalid select\",\r\n\t\t\t\tviewValue: \"\"\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (match != token.select[value]) {\r\n\t\t\treturn {\r\n\t\t\t\terr: 1,\r\n\t\t\t\tcode: \"SELECT_INCOMPLETE\",\r\n\t\t\t\tmessage: \"Incomplete select\",\r\n\t\t\t\tvalue: value + 1,\r\n\t\t\t\tviewValue: match,\r\n\t\t\t\tselected: token.select[value]\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tvalue: value + 1,\r\n\t\t\tviewValue: match\r\n\t\t};\r\n\t}\r\n\r\n\tthrow \"Unknown token type: \" + token.type;\r\n}\r\n\r\nfunction parseNodes(nodes, text) {\r\n\tvar pos = 0, node, result = [], r;\r\n\r\n\tfor (node of nodes) {\r\n\t\tr = parseNode(text, node.token, pos);\r\n\t\tr.node = node;\r\n\t\tr.pos = pos;\r\n\t\tr.token = node.token;\r\n\t\tif (r.err >= 2) {\r\n\t\t\tr.text = text;\r\n\t\t\tthrow r;\r\n\t\t}\r\n\t\tpos += r.viewValue.length;\r\n\t\tresult.push(r);\r\n\t}\r\n\r\n\t// throw TEXT_TOOLONG error\r\n\tvar last = result[result.length - 1];\r\n\tif (last.pos + last.viewValue.length < text.length) {\r\n\t\tthrow {\r\n\t\t\tcode: \"TEXT_TOOLONG\",\r\n\t\t\tmessage: \"Text is too long\",\r\n\t\t\ttext: text\r\n\t\t};\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction formatNode(value, token) {\r\n\tif (token.type == \"static\") {\r\n\t\treturn {\r\n\t\t\tviewValue: token.value\r\n\t\t};\r\n\t}\r\n\tvar v = token.extract(value);\r\n\tif (token.type == \"number\") {\r\n\t\treturn {\r\n\t\t\tvalue: v,\r\n\t\t\tviewValue: num2str(v, token.minLength, token.maxLength)\r\n\t\t};\r\n\t}\r\n\tif (token.type == \"select\") {\r\n\t\treturn {\r\n\t\t\tvalue: v,\r\n\t\t\tviewValue: token.select[v - 1]\r\n\t\t};\r\n\t}\r\n\tthrow \"Unknown type to format: \" + token.type;\r\n}\r\n\r\nfunction formatNodes(value, nodes, ignoreEmpty) {\r\n\tvar result = [], r, node;\r\n\tfor (node of nodes) {\r\n\t\tr = formatNode(value, node.token);\r\n\t\tif (node.token.type != \"static\" && node.empty && !ignoreEmpty) {\r\n\t\t\tr.value = null;\r\n\t\t\tr.viewValue = node.token.placeholder;\r\n\t\t}\r\n\t\tresult.push(r);\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nclass Node {\r\n\tconstructor (parser, token) {\r\n\t\tthis.parser = parser;\r\n\t\tthis.token = token;\r\n\t\tthis.value = null;\r\n\t\tthis.viewValue = token.value;\r\n\t\tthis.offset = 0;\r\n\t\tthis.next = null;\r\n\t\tthis.prev = null;\r\n\t\tthis.nextEdit = null;\r\n\t\tthis.prevEdit = null;\r\n\t\tthis.empty = true;\r\n\t}\r\n\r\n\tunset () {\r\n\t\tif (this.token.type == \"static\" || this.parser.noEmpty) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.empty = true;\r\n\t\tthis.parser.setValue(this.parser.value, false);\r\n\t}\r\n\r\n\tparse (text, pos = 0) {\r\n\t\tvar result = parseNode(text, this.token, pos);\r\n\t\tif (result.err) {\r\n\t\t\tresult.node = this;\r\n\t\t\tresult.token = this.token;\r\n\t\t\tthrow result;\r\n\t\t}\r\n\r\n\t\tif (this.parser.noEmpty && result.empty) {\r\n\t\t\tthrow {\r\n\t\t\t\tcode: \"NOT_INIT_FORBIDDEN\",\r\n\t\t\t\tmessage: \"Empty node is forbidden\",\r\n\t\t\t\tnode: this\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (result.empty) {\r\n\t\t\tthis.unset();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.empty = false;\r\n\r\n\t\tvar value = restoreValue(this.parser.copyValue(this.parser.value), this.token, result.value, this.parser);\r\n\t\tthis.parser.setValue(value, false);\r\n\t}\r\n\r\n\tadd (diff) {\r\n\t\tvar value = this.parser.copyValue(this.parser.value),\r\n\t\t\tnodeValue;\r\n\r\n\t\tthis.empty = false;\r\n\r\n\t\tvalue = addValue(value, this.token, diff, this.parser);\r\n\t\tnodeValue = this.token.extract(value);\r\n\r\n\t\t// min/max check\r\n\t\tvar min, max;\r\n\t\tif (this.token.type == \"number\") {\r\n\t\t\tmin = this.token.min;\r\n\t\t\tmax = this.token.max;\r\n\t\t} else if (this.token.type == \"select\") {\r\n\t\t\tmin = 1;\r\n\t\t\tmax = this.token.select.length;\r\n\t\t}\r\n\t\t\r\n\t\tif (nodeValue < min) {\r\n\t\t\tvalue = restoreValue(value, this.token, min, this.parser);\r\n\t\t}\r\n\t\tif (nodeValue > max) {\r\n\t\t\tvalue = restoreValue(value, this.token, max, this.parser);\r\n\t\t}\r\n\r\n\t\tthis.parser.setValue(value, false);\r\n\t}\r\n}\r\n\r\nfunction addValue(o, tk, v, p) {\r\n\tif (typeof o == \"object\") {\r\n\t\ttk.add(o, v, p);\r\n\t\treturn o;\r\n\t} else {\r\n\t\treturn tk.add(o, v, p);\r\n\t}\r\n}\r\n\r\nfunction restoreValue(o, tk, v, p) {\r\n\tif (typeof o == \"object\") {\r\n\t\ttk.restore(o, v, p);\r\n\t\treturn o;\r\n\t} else {\r\n\t\treturn tk.restore(o, v, p);\r\n\t}\r\n}\r\n\r\nfunction createNodes(parser, tokens) {\r\n\tvar tk, i, edit,\r\n\t\tnodes = [];\r\n\r\n\tfor (tk of tokens) {\r\n\t\tnodes.push(new Node(parser, tk));\r\n\t}\r\n\t// Build relationship between nodes\r\n\tfor (i = 0; i < nodes.length; i++) {\r\n\t\tnodes[i].next = nodes[i + 1] || null;\r\n\t\tnodes[i].prev = nodes[i - 1] || null;\r\n\t}\r\n\r\n\tedit = null;\r\n\tfor (i = 0; i < nodes.length; i++) {\r\n\t\tnodes[i].prevEdit = edit;\r\n\t\tif (nodes[i].token.type != \"static\") {\r\n\t\t\tedit = nodes[i];\r\n\t\t}\r\n\t}\r\n\r\n\tedit = null;\r\n\tfor (i = nodes.length - 1; i >= 0; i--) {\r\n\t\tnodes[i].nextEdit = edit;\r\n\t\tif (nodes[i].token.type != \"static\") {\r\n\t\t\tedit = nodes[i];\r\n\t\t}\r\n\t}\r\n\r\n\treturn nodes;\r\n}\r\n\r\nfunction nocopy(o) {\r\n\treturn o;\r\n}\r\n\r\nfunction createNameMap(nodes) {\r\n\tvar map = new Map;\r\n\tfor (var node of nodes) {\r\n\t\tvar l = map.get(node.token.name);\r\n\t\tif (!l) {\r\n\t\t\tl = [];\r\n\t\t\tmap.set(node.token.name, l);\r\n\t\t}\r\n\t\tl.push(node);\r\n\t}\r\n\treturn map;\r\n}\r\n\r\n// a stated text parser\r\nclass TextParser extends Emitter {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._constructor.apply(this, arguments);\r\n\t\tthis.initialize();\r\n\t}\r\n\t\r\n\t_constructor ({tokens, noEmpty = false, value, text, copyValue = nocopy}) {\r\n\t\tif (!tokens || !tokens.length) {\r\n\t\t\tthrow new Error(\"option.tokens is required\");\r\n\t\t}\r\n\t\tthis.tokens = tokens;\r\n\t\tthis.nodes = createNodes(this, tokens);\r\n\t\tthis.nameMap = createNameMap(this.nodes);\r\n\t\tthis.value = value;\r\n\t\tthis.text = text;\r\n\t\tthis.noEmpty = noEmpty;\r\n\t\tthis.copyValue = copyValue;\r\n\t\tthis.err = false;\r\n\t}\r\n\t\r\n\tinitialize() {\r\n\t\tthis.setValue(this.value);\r\n\t}\r\n\r\n\tparse (text) {\r\n\t\tif (!text) {\r\n\t\t\tthrow {\r\n\t\t\t\tcode: \"EMPTY\",\r\n\t\t\t\tmessage: \"The input is empty\",\r\n\t\t\t\toldText: this.text\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar result, i;\r\n\t\t\r\n\t\tresult = parseNodes(this.nodes, text);\r\n\r\n\t\t// grab changed nodes\r\n\t\tvar changed = [], comparer;\r\n\t\t\r\n\t\tif (this.err) {\r\n\t\t\tcomparer = parseNodes(this.nodes, this.text);\r\n\t\t} else {\r\n\t\t\tcomparer = this.nodes;\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i < result.length; i++) {\r\n\t\t\tif (!result[i].empty && result[i].viewValue != comparer[i].viewValue) {\r\n\t\t\t\t// expose token for sorting and consistent check\r\n\t\t\t\tresult[i].token = this.nodes[i].token;\r\n\t\t\t\tchanged.push(result[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// grab empty nodes\r\n\t\tvar empties = result.filter(r => r.empty),\r\n\t\t\terrors = result.filter(r => r.err);\r\n\r\n\t\t// copy result value into nodes\r\n\t\tfor (i = 0; i < result.length; i++) {\r\n\t\t\tthis.nodes[i].value = result[i].value;\r\n\t\t\tthis.nodes[i].viewValue = result[i].viewValue;\r\n\t\t\tthis.nodes[i].offset = result[i].pos;\r\n\t\t\tthis.nodes[i].empty = result[i].empty;\r\n\t\t}\r\n\r\n\t\t// throw error\r\n\t\tif (errors.length) {\r\n\t\t\tthis.err = true;\r\n\t\t\tthrow errors[0];\r\n\t\t} else {\r\n\t\t\tthis.err = false;\r\n\t\t}\r\n\r\n\t\t// sort result\r\n\t\tchanged.sort((a, b) => {\r\n\t\t\tif (b.empty) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif (a.empty) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn (b.token.prior || 0) - (a.token.prior || 0);\r\n\t\t});\r\n\r\n\t\t// consistent check\r\n\t\tvar c, value = this.copyValue(this.value);\r\n\t\tfor (c of changed) {\r\n\t\t\tvalue = restoreValue(value, c.token, c.value, this);\r\n\t\t}\r\n\r\n\t\tvar newText = formatNodes(value, result).map(r => r.viewValue).join(\"\");\r\n\t\tif (text != newText) {\r\n\t\t\tthis.err = true;\r\n\t\t\tthrow {\r\n\t\t\t\tcode: \"INCONSISTENT_INPUT\",\r\n\t\t\t\tmessage: \"Successfully parsed but the output text doesn't match the input\",\r\n\t\t\t\ttext: text,\r\n\t\t\t\toldText: this.text,\r\n\t\t\t\tproperText: newText\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Done. Manipulate value and text\r\n\t\tthis.text = text;\r\n\t\tthis.value = value;\r\n\r\n\t\tthis.emit(\"change\", this.value);\r\n\r\n\t\t// throw not_init error\r\n\t\tif (empties.length) {\r\n\t\t\tthrow {\r\n\t\t\t\tcode: \"NOT_INIT\",\r\n\t\t\t\tmessage: \"Some nodes are empty\",\r\n\t\t\t\ttext: text,\r\n\t\t\t\tnode: empties[0]\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetValue (value, ignoreEmpty = true) {\r\n\t\t// value => text\r\n\t\tvar result = formatNodes(value, this.nodes, ignoreEmpty);\r\n\t\tvar i, pos = 0, text = \"\";\r\n\t\tfor (i = 0; i < result.length; i++) {\r\n\t\t\tthis.nodes[i].value = result[i].value;\r\n\t\t\tthis.nodes[i].viewValue = result[i].viewValue;\r\n\t\t\tthis.nodes[i].offset = pos;\r\n\t\t\tthis.nodes[i].empty = ignoreEmpty ? false : this.nodes[i].empty;\r\n\t\t\tpos += this.nodes[i].viewValue.length;\r\n\t\t\ttext += this.nodes[i].viewValue;\r\n\t\t}\r\n\t\tthis.value = value;\r\n\t\tthis.text = text;\r\n\r\n\t\tthis.emit(\"change\", this.value);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tisEmpty (text) {\r\n\t\tvar result;\r\n\t\tif (text) {\r\n\t\t\ttry {\r\n\t\t\t\tresult = parseNodes(this.nodes, text);\r\n\t\t\t} catch (err) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresult = this.nodes;\r\n\t\t}\r\n\t\tvar i;\r\n\t\tfor (i = 0; i < result.length; i++) {\r\n\t\t\tif (this.nodes[i].token.type != \"static\" && !result[i].empty) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tisInit() {\r\n\t\tvar node;\r\n\t\tfor (node of this.nodes) {\r\n\t\t\tif (node.token.type != \"static\" && node.empty) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tunset() {\r\n\t\tvar node;\r\n\t\tfor (node of this.nodes) {\r\n\t\t\tnode.empty = true;\r\n\t\t}\r\n\t\tthis.setValue(this.value, false);\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tgetText() {\r\n\t\treturn this.text;\r\n\t}\r\n\r\n\tgetValue() {\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\tgetNodes(name) {\r\n\t\tif (name) {\r\n\t\t\treturn this.nameMap.get(name);\r\n\t\t}\r\n\t\treturn this.nodes;\r\n\t}\r\n}\r\n\r\nmodule.exports = {\r\n\tTextParser\r\n};\r\n","var {Emitter} = require(\"./utils\");\r\n\r\nfunction findNearestNode(i, nodes) {\r\n\tif (!nodes.length) return;\r\n\r\n\tvar [left, right] = matchNodes(nodes, i).map(r => r.node);\r\n\r\n\tif (left == right) {\r\n\t\treturn left;\r\n\t}\r\n\r\n\tif (i - left.offset - left.viewValue.length <= right.offset - i) {\r\n\t\treturn left;\r\n\t}\r\n\r\n\treturn right;\r\n}\r\n\r\nfunction matchNodes(nodes, start, end = start) {\r\n\tvar node, left, right;\r\n\r\n\tfor (node of nodes) {\r\n\t\tif (node.offset <= start) {\r\n\t\t\tleft = {\r\n\t\t\t\tnode: node,\r\n\t\t\t\tpos: start - node.offset\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (node.offset + node.viewValue.length >= end && !right) {\r\n\t\t\tright = {\r\n\t\t\t\tnode: node,\r\n\t\t\t\tpos: end - node.offset\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tif (!right) {\r\n\t\tvar last = nodes[nodes.length - 1];\r\n\t\tright = {\r\n\t\t\tnode: last,\r\n\t\t\tpos: last.viewValue.length\r\n\t\t};\r\n\t}\r\n\r\n\tif (!left) {\r\n\t\tvar first = nodes[0];\r\n\t\tleft = {\r\n\t\t\tnode: first,\r\n\t\t\tpos: 0\r\n\t\t};\r\n\t}\r\n\r\n\tif (left.pos > left.node.viewValue.length) {\r\n\t\tleft.pos = left.node.viewValue.length;\r\n\t}\r\n\r\n\treturn [left, right];\r\n}\r\n\r\nclass Selection {\r\n\tconstructor(element, nodes) {\r\n\t\tthis.el = element;\r\n\t\tthis.nodes = nodes;\r\n\t\tthis.range = {\r\n\t\t\tnode: findNearestNode(0, this.nodes),\r\n\t\t\tstart: 0,\r\n\t\t\tend: \"end\"\r\n\t\t};\r\n\t}\r\n\tselectNearestNode() {\r\n\t\tvar range = this.el.getSelection();\r\n\t\tif (!range) return;\r\n\t\t\r\n\t\tthis.select({\r\n\t\t\tnode: findNearestNode(range.start, this.nodes),\r\n\t\t\tstart: 0,\r\n\t\t\tend: \"end\"\r\n\t\t});\r\n\t}\r\n\tselect(range) {\r\n\t\trange = Object.assign(this.range, range);\r\n\t\tif (range.node) {\r\n\t\t\tthis.el.setSelection(\r\n\t\t\t\trange.node.offset + range.start,\r\n\t\t\t\trange.node.offset + (range.end == \"end\" ? range.node.viewValue.length : range.end)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\thasNext() {\r\n\t\tif (this.range.node) {\r\n\t\t\treturn this.range.node.nextEdit;\r\n\t\t}\r\n\t}\r\n\thasPrev() {\r\n\t\tif (this.range.node) {\r\n\t\t\treturn this.range.node.prevEdit;\r\n\t\t}\r\n\t}\r\n\tselectNext() {\r\n\t\tvar node = this.hasNext(),\r\n\t\t\trange = {start: 0, end: \"end\"};\r\n\t\tif (node) {\r\n\t\t\trange.node = node;\r\n\t\t}\r\n\t\tthis.select(range);\r\n\t}\r\n\tselectPrev() {\r\n\t\tvar node = this.hasPrev(),\r\n\t\t\trange = {start: 0, end: \"end\"};\r\n\t\tif (node) {\r\n\t\t\trange.node = node;\r\n\t\t}\r\n\t\tthis.select(range);\r\n\t}\r\n\tget() {\r\n\t\tif (!this.nodes.length) return;\r\n\t\t\r\n\t\tvar range = this.el.getSelection();\r\n\t\t\r\n\t\tif (!range) return;\r\n\r\n\t\tvar [left, right] = matchNodes(this.nodes, range.start, range.end);\r\n\r\n\t\tif (left.node == right.node) {\r\n\t\t\tthis.range = {\r\n\t\t\t\tnode: left.node,\r\n\t\t\t\tstart: left.pos,\r\n\t\t\t\tend: right.pos\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\tatNodeEnd() {\r\n\t\tif (!this.range.node) return;\r\n\r\n\t\tthis.get();\r\n\r\n\t\tvar len = this.range.node.viewValue.length,\r\n\t\t\tmax = this.range.node.token.maxLength,\r\n\t\t\tstart = this.range.start == \"end\" ? len : this.range.start,\r\n\t\t\tend = this.range.end == \"end\" ? len : this.range.end;\r\n\r\n\t\treturn start == end && start == (max != null ? max : len) || !len;\r\n\t}\r\n\tatNodeStart() {\r\n\t\tif (!this.range.node) return;\r\n\r\n\t\tthis.get();\r\n\r\n\t\tvar len = this.range.node.viewValue.length,\r\n\t\t\tstart = this.range.start == \"end\" ? len : this.range.start,\r\n\t\t\tend = this.range.end == \"end\" ? len : this.range.end;\r\n\r\n\t\treturn start == end && start == 0;\r\n\t}\r\n}\r\n\r\nclass InputMask extends Emitter {\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._constructor.apply(this, arguments);\r\n\t\tthis.initialize();\r\n\t}\r\n\r\n\t_constructor(element, textParser, separators = \"\") {\r\n\t\tthis.el = element;\r\n\t\tthis.tp = textParser;\r\n\t\tthis.separators = separators;\r\n\t\tthis.sel = new Selection(element, textParser.getNodes().filter(n => n.token.type != \"static\"));\r\n\t}\r\n\r\n\tinitialize() {\r\n\t\tthis.el.on(\"mousedown\", () => {\r\n\t\t\tthis.mousedown = true;\r\n\t\t});\r\n\r\n\t\tthis.el.on(\"focus\", () => {\r\n\t\t\tif (this.mousedown) return;\t// wait mouseup then decide range\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.sel.select({\r\n\t\t\t\t\tstart: 0,\r\n\t\t\t\t\tend: \"end\"\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.el.on(\"click\", () => {\r\n\t\t\tthis.mousedown = false;\r\n\t\t\tthis.sel.selectNearestNode();\r\n\t\t});\r\n\r\n\t\tthis.el.on(\"input\", () => {\r\n\t\t\tthis.digest(null, this.el.val());\r\n\t\t});\r\n\r\n\t\tthis.el.on(\"keydown\", (e) => {\r\n\t\t\tif (e.altKey || e.ctrlKey) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (e.keyCode == 37 || e.keyCode == 9 && e.shiftKey && this.sel.hasPrev()) {\r\n\t\t\t\t// Left, Shift + Tab\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.tryFixingError();\r\n\t\t\t\tthis.sel.selectPrev();\r\n\t\t\t} else if (e.keyCode == 39 || e.keyCode == 9 && !e.shiftKey && this.sel.hasNext()) {\r\n\t\t\t\t// Right, Tab\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.tryFixingError();\r\n\t\t\t\tthis.sel.selectNext();\r\n\t\t\t} else if (e.keyCode == 38) {\r\n\t\t\t\t// Up\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.sel.selectNearestNode();\r\n\t\t\t\tif (this.sel.range.node) {\r\n\t\t\t\t\t// this.err = null;\r\n\t\t\t\t\tthis.sel.range.node.add(1);\r\n\t\t\t\t}\r\n\t\t\t\tthis.val(this.tp.getText());\r\n\t\t\t\tthis.sel.select({\r\n\t\t\t\t\tstart: 0,\r\n\t\t\t\t\tend: \"end\"\r\n\t\t\t\t});\r\n\t\t\t} else if (e.keyCode == 40) {\r\n\t\t\t\t// Down\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.sel.selectNearestNode();\r\n\t\t\t\tif (this.sel.range.node) {\r\n\t\t\t\t\t// this.err = null;\r\n\t\t\t\t\tthis.sel.range.node.add(-1);\r\n\t\t\t\t}\r\n\t\t\t\tthis.val(this.tp.getText());\r\n\t\t\t\tthis.sel.select({\r\n\t\t\t\t\tstart: 0,\r\n\t\t\t\t\tend: \"end\"\r\n\t\t\t\t});\r\n\t\t\t} else if (e.keyCode == 36 || e.keyCode == 35) {\r\n\t\t\t\t// Home or End\r\n\t\t\t\tsetTimeout(() => this.sel.selectNearestNode());\r\n\t\t\t} else if (e.keyCode == 46) {\r\n\t\t\t\t// Del\r\n\t\t\t\tif (this.sel.atNodeEnd()) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tthis.tryFixingError();\r\n\t\t\t\t\tthis.sel.selectNext();\r\n\t\t\t\t}\r\n\t\t\t} else if (e.keyCode == 8) {\r\n\t\t\t\t// Backspace\r\n\t\t\t\tif (this.sel.atNodeStart()) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tthis.tryFixingError();\r\n\t\t\t\t\tthis.sel.selectPrev();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.el.on(\"keypress\", e => {\r\n\t\t\tvar charCode = e.charCode == null ? e.keyCode : e.charCode,\r\n\t\t\t\tkey = String.fromCharCode(charCode),\r\n\t\t\t\tseparators = this.separators,\r\n\t\t\t\tnode = this.sel.range.node;\r\n\r\n\t\t\t// check for separator only when there is a next node which is static string\r\n\t\t\tif (node && node.next && node.next.token.type == \"static\") {\r\n\t\t\t\tseparators += node.next.viewValue[0];\r\n\t\t\t}\r\n\r\n\t\t\tif (separators.includes(key)) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.tryFixingError();\r\n\t\t\t\tthis.sel.selectNext();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this.sel.atNodeEnd() && this.sel.range.node.viewValue) {\r\n\t\t\t\t\tthis.tryFixingError();\r\n\t\t\t\t\tthis.sel.selectNext();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.el.on(\"blur\", () => {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.tryFixingError();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.tp.on(\"change\", () => {\r\n\t\t\tif (!this.err && !this.inDigest) {\r\n\t\t\t\tthis.val(this.tp.getText());\r\n\t\t\t\tthis.sel.select();\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// Init value\r\n\t\tvar text = this.el.val();\r\n\t\tif (text) {\r\n\t\t\tthis.digest(null, text, true);\r\n\t\t} else {\r\n\t\t\tthis.val(this.tp.getText());\r\n\t\t}\r\n\t}\r\n\terrorViewLength() {\r\n\t\tif (this.err && this.err.viewValue != null) {\r\n\t\t\treturn this.err.viewValue.length;\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\tval(text) {\r\n\t\tif (this.el.val() != text) {\r\n\t\t\tthis.el.val(text);\r\n\t\t}\r\n\t\tthis.err = null;\r\n\t}\r\n\ttryFixingError() {\r\n\t\tif (!this.err) return;\r\n\r\n\t\tif (this.err.properValue) {\r\n\t\t\tthis.digest(this.err.node, this.err.properValue, true);\r\n\r\n\t\t} else if (this.err.node) {\r\n\t\t\tthis.err.node.unset();\r\n\t\t\tthis.digest(null, this.tp.getText());\r\n\t\t}\r\n\t}\r\n\tdigest(node, text, fixErr) {\r\n\t\tvar digest = 10,\r\n\t\t\trange;\r\n\r\n\t\tthis.inDigest = true;\r\n\r\n\t\twhile (digest--) {\r\n\t\t\tthis.err = null;\r\n\t\t\ttry {\r\n\t\t\t\tif (node) {\r\n\t\t\t\t\tnode.parse(text);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.tp.parse(text);\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tthis.emit(\"digest\", err);\r\n\t\t\t\t\r\n\t\t\t\tthis.sel.get();\r\n\r\n\t\t\t\tif (err.code == \"NOT_INIT\") {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.err = err;\r\n\r\n\t\t\t\tif (!fixErr && (err.code == \"NUMBER_TOOSHORT\" || err.code == \"NUMBER_TOOSMALL\" || err.code == \"NUMBER_MISMATCH\" || err.code == \"SELECT_MISMATCH\" || err.code == \"LEADING_ZERO\")) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (err.code == \"SELECT_INCOMPLETE\") {\r\n\t\t\t\t\tnode = err.node;\r\n\t\t\t\t\ttext = err.selected;\r\n\t\t\t\t\trange = {end: \"end\"};\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (err.properValue != null) {\r\n\t\t\t\t\tnode = err.node;\r\n\t\t\t\t\ttext = err.properValue;\r\n\t\t\t\t} else if (err.properText != null) {\r\n\t\t\t\t\tnode = null;\r\n\t\t\t\t\ttext = err.properText;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (err.code == \"EMPTY\") {\r\n\t\t\t\t\t\tthis.tp.unset();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (err.node) {\r\n\t\t\t\t\t\terr.node.unset();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnode = null;\r\n\t\t\t\t\ttext = this.tp.getText();\r\n\t\t\t\t\trange = {start: 0, end: \"end\"};\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (!this.err) {\r\n\t\t\tthis.val(this.tp.getText());\r\n\t\t\tif (digest < 9) {\r\n\t\t\t\tthis.sel.select(range);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.inDigest = false;\r\n\r\n\t\tif (digest < 0) {\r\n\t\t\tthrow new Error(`InputMask.digest crashed! Infinite loop on ${text}`);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports = {\r\n\tInputMask\r\n};\r\n","module.exports = {\r\n\tTextParser: require(\"./lib/text-parser\").TextParser,\r\n\tInputMask: require(\"./lib/input-mask\").InputMask,\r\n\tutils: require(\"./lib/utils\")\r\n};\r\n","var angular = require(\"angular\"),\r\n\t{TextParser} = require(\"custom-input\"),\r\n\t{num2str} = require(\"custom-input/lib/utils\");\r\n\r\nangular.module(\"datetime\").factory(\"datetime\", init);\r\ninit.$inject = [\"$locale\", \"datetimePlaceholder\"];\r\nfunction init($locale, datetimePlaceholder) {\r\n\t// Fetch date and time formats from $locale service\r\n\tvar formats = $locale.DATETIME_FORMATS;\r\n\t// Valid format tokens. 1=sss, 2=''\r\n\tvar tokenRE = /yyyy|yy|y|M{1,4}|dd?|EEEE?|HH?|hh?|mm?|ss?|([.,])sss|a|Z{1,2}|ww|w|'(([^']+|'')*)'/g;\r\n\t// Token definition\r\n\tvar definedTokens = {\r\n\t\t\"y\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 4,\r\n\t\t\tmax: 9999,\r\n\t\t\tmin: 0,\r\n\t\t\tname: \"year\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"yy\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"yearShort\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"yyyy\": {\r\n\t\t\tminLength: 4,\r\n\t\t\tmaxLength: 4,\r\n\t\t\tmax: 9999,\r\n\t\t\tmin: 0,\r\n\t\t\tname: \"year\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"MMMM\": {\r\n\t\t\tname: \"month\",\r\n\t\t\ttype: \"select\",\r\n\t\t\tselect: formats.MONTH\r\n\t\t},\r\n\t\t\"MMM\": {\r\n\t\t\tname: \"month\",\r\n\t\t\ttype: \"select\",\r\n\t\t\tselect: formats.SHORTMONTH\r\n\t\t},\r\n\t\t\"MM\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"month\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"M\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"month\",\r\n\t\t\ttype: \"number\",\r\n\t\t\tmin: 1\r\n\t\t},\r\n\t\t\"dd\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"date\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"d\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"date\",\r\n\t\t\ttype: \"number\",\r\n\t\t\tmin: 1\r\n\t\t},\r\n\t\t\"EEEE\": {\r\n\t\t\tname: \"day\",\r\n\t\t\ttype: \"select\",\r\n\t\t\tselect: fixDay(formats.DAY)\r\n\t\t},\r\n\t\t\"EEE\": {\r\n\t\t\tname: \"day\",\r\n\t\t\ttype: \"select\",\r\n\t\t\tselect: fixDay(formats.SHORTDAY)\r\n\t\t},\r\n\t\t\"HH\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"hour\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"H\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"hour\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"hh\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"hour12\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"h\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"hour12\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"mm\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"minute\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"m\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"minute\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"ss\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"second\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"s\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tname: \"second\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"sss\": {\r\n\t\t\tminLength: 3,\r\n\t\t\tmaxLength: 3,\r\n\t\t\tname: \"millisecond\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"a\": {\r\n\t\t\tname: \"ampm\",\r\n\t\t\ttype: \"select\",\r\n\t\t\tselect: formats.AMPMS\r\n\t\t},\r\n\t\t\"ww\": {\r\n\t\t\tminLength: 2,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tmax: 53,\r\n\t\t\tname: \"week\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"w\": {\r\n\t\t\tminLength: 1,\r\n\t\t\tmaxLength: 2,\r\n\t\t\tmax: 53,\r\n\t\t\tname: \"week\",\r\n\t\t\ttype: \"number\"\r\n\t\t},\r\n\t\t\"Z\": {\r\n\t\t\tname: \"timezone\",\r\n\t\t\ttype: \"static\"\r\n\t\t},\r\n\t\t\"ZZ\": {\r\n\t\t\tname: \"timezone\",\r\n\t\t\ttype: \"static\",\r\n\t\t\tcolon: true\r\n\t\t},\r\n\t\t\"string\": {\r\n\t\t\tname: \"string\",\r\n\t\t\ttype: \"static\"\r\n\t\t}\r\n\t};\r\n\t\r\n\tvar nameConf = {\r\n\t\tyear: {\r\n\t\t\textract: d => {\r\n\t\t\t\t// year might be negative\r\n\t\t\t\tvar v = d.getFullYear() % 10000;\r\n\t\t\t\treturn v >= 0 ? v : 0;\r\n\t\t\t},\r\n\t\t\trestore: (d, v) => d.setFullYear(v),\r\n\t\t\tadd: (d, v) => d.setFullYear(d.getFullYear() + v),\r\n\t\t\tprior: 7\r\n\t\t},\r\n\t\tyearShort: {\r\n\t\t\textract: d => {\r\n\t\t\t\tvar v = d.getFullYear() % 100;\r\n\t\t\t\treturn v >= 0 ? v : v + 100;\r\n\t\t\t},\r\n\t\t\trestore: (d, v) => d.setFullYear(v),\r\n\t\t\tadd: (d, v) => d.setFullYear(d.getFullYear() + v),\r\n\t\t\tprior: 7\r\n\t\t},\r\n\t\tmonth: {\r\n\t\t\textract: d => d.getMonth() + 1,\r\n\t\t\trestore: (d, v) => {\r\n\t\t\t\t// http://stackoverflow.com/questions/14680396/the-date-getmonth-method-has-bug\r\n\t\t\t\td.setMonth(v - 1);\r\n\t\t\t\t// handle date overflow\r\n\t\t\t\tif (d.getMonth() == v) {\r\n\t\t\t\t\td.setDate(0);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tadd: (d, v) => {\r\n\t\t\t\tv = d.getMonth() + v;\r\n\t\t\t\td.setMonth(v);\r\n\t\t\t\t// date overflow\r\n\t\t\t\tif (d.getMonth() == v + 1) {\r\n\t\t\t\t\td.setDate(0);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprior: 5\r\n\t\t},\r\n\t\tdate: {\r\n\t\t\textract: d => d.getDate(),\r\n\t\t\trestore: (d, v, p) => {\r\n\t\t\t\t// handle overflowed day\r\n\t\t\t\tvar oldMonth = d.getMonth();\r\n\t\t\t\td.setDate(v);\r\n\t\t\t\tif (d.getMonth() != oldMonth && v <= 31) {\r\n\t\t\t\t\tvar monthNodes = p.getNodes(\"month\");\r\n\t\t\t\t\tif (monthNodes && monthNodes.every(n => n.empty)) {\r\n\t\t\t\t\t\td.setDate(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tadd(d, v, p) {\r\n\t\t\t\tthis.restore(d, d.getDate() + v, p);\r\n\t\t\t},\r\n\t\t\tprior: 4\r\n\t\t},\r\n\t\tday: {\r\n\t\t\textract: d => d.getDay() || 7,\r\n\t\t\trestore: setDay,\r\n\t\t\tadd: (d, v) => d.setDate(d.getDate() + v),\r\n\t\t\tprior: 4\r\n\t\t},\r\n\t\thour: {\r\n\t\t\textract: d => d.getHours(),\r\n\t\t\trestore: (d, v) => d.setHours(v),\r\n\t\t\tadd: (d, v) => d.setHours(d.getHours() + v),\r\n\t\t\tprior: 2\r\n\t\t},\r\n\t\thour12: {\r\n\t\t\textract: d => d.getHours() % 12 || 12,\r\n\t\t\trestore: setHour12,\r\n\t\t\tadd: (d, v) => d.setHours(d.getHours() + v),\r\n\t\t\tprior: 2\r\n\t\t},\r\n\t\tampm: {\r\n\t\t\textract: d => d.getHours() < 12 ? 1 : 2,\r\n\t\t\trestore: setAmpm,\r\n\t\t\tadd: (d, v) => d.setHours(d.getHours() + v * 12),\r\n\t\t\tprior: 3\r\n\t\t},\r\n\t\tminute: {\r\n\t\t\textract: d => d.getMinutes(),\r\n\t\t\trestore: (d, v) => d.setMinutes(v),\r\n\t\t\tadd: (d, v) => d.setMinutes(d.getMinutes() + v),\r\n\t\t\tprior: 0\r\n\t\t},\r\n\t\tsecond: {\r\n\t\t\textract: d => d.getSeconds(),\r\n\t\t\trestore: (d, v) => d.setSeconds(v),\r\n\t\t\tadd: (d, v) => d.setSeconds(d.getSeconds() + v),\r\n\t\t\tprior: 1\r\n\t\t},\r\n\t\tmillisecond: {\r\n\t\t\textract: d => d.getMilliseconds(),\r\n\t\t\trestore: (d, v) => d.setMilliseconds(v),\r\n\t\t\tadd: (d, v) => d.setMilliseconds(d.getMilliseconds() + v),\r\n\t\t\tprior: 1\r\n\t\t},\r\n\t\tweek: {\r\n\t\t\textract: getWeek,\r\n\t\t\trestore: (d, v) => d.setDate(d.getDate() + (v - getWeek(d)) * 7),\r\n\t\t\tadd: (d, v) => d.setDate(d.getDate() + v * 7),\r\n\t\t\tprior: 6\r\n\t\t}\r\n\t};\r\n\t\r\n\t// setup placeholder\r\n\tfor (var name in nameConf) {\r\n\t\tnameConf[name].placeholder = datetimePlaceholder[name];\r\n\t}\r\n\t\r\n\t// setup tokens\r\n\tfor (var tk of Object.values(definedTokens)) {\r\n\t\tif (nameConf[tk.name]) {\r\n\t\t\tangular.extend(tk, nameConf[tk.name]);\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar SYS_TIMEZONE = (function(){\r\n\t\tvar offset = -(new Date).getTimezoneOffset(),\r\n\t\t\tsign = offset >= 0 ? \"+\" : \"-\",\r\n\t\t\tabsOffset = Math.abs(offset),\r\n\t\t\thour = Math.floor(absOffset / 60),\r\n\t\t\tmin = absOffset % 60;\r\n\t\treturn sign + num2str(hour, 2, 2) + num2str(min, 2, 2);\r\n\t})();\r\n\r\n\t// Push Sunday to the end\r\n\tfunction fixDay(days) {\r\n\t\tvar s = [], i;\r\n\t\tfor (i = 1; i < days.length; i++) {\r\n\t\t\ts.push(days[i]);\r\n\t\t}\r\n\t\ts.push(days[0]);\r\n\t\treturn s;\r\n\t}\r\n\r\n\t// Split format into multiple tokens\r\n\tfunction createTokens(format) {\r\n\t\tvar tokens = [],\r\n\t\t\tpos = 0,\r\n\t\t\tmatch;\r\n\t\t\t\r\n\t\twhile ((match = tokenRE.exec(format))) {\r\n\t\t\tif (match.index > pos) {\r\n\t\t\t\t// doesn't match any token, static string\r\n\t\t\t\ttokens.push(angular.extend({\r\n\t\t\t\t\tvalue: format.substring(pos, match.index)\r\n\t\t\t\t}, definedTokens.string));\r\n\t\t\t\tpos = match.index;\r\n\t\t\t} \r\n\r\n\t\t\tif (match.index == pos) {\r\n\t\t\t\tif (match[1]) {\r\n\t\t\t\t\t// sss\r\n\t\t\t\t\ttokens.push(angular.extend({\r\n\t\t\t\t\t\tvalue: match[1]\r\n\t\t\t\t\t}, definedTokens.string));\r\n\t\t\t\t\ttokens.push(definedTokens.sss);\r\n\t\t\t\t} else if (match[2]) {\r\n\t\t\t\t\t// escaped string\r\n\t\t\t\t\ttokens.push(angular.extend({\r\n\t\t\t\t\t\tvalue: match[2].replace(\"''\", \"'\")\r\n\t\t\t\t\t}, definedTokens.string));\r\n\t\t\t\t} else if (definedTokens[match[0]].name == \"timezone\") {\r\n\t\t\t\t\t// static timezone\r\n\t\t\t\t\tvar tz = SYS_TIMEZONE;\r\n\t\t\t\t\tif (definedTokens[match[0]].colon) {\r\n\t\t\t\t\t\ttz = insertColon(tz);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttokens.push(angular.extend({\r\n\t\t\t\t\t\tvalue: tz\r\n\t\t\t\t\t}, definedTokens[match[0]]));\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// other tokens\r\n\t\t\t\t\ttokens.push(definedTokens[match[0]]);\r\n\t\t\t\t}\r\n\t\t\t\tpos = tokenRE.lastIndex;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (pos < format.length) {\r\n\t\t\ttokens.push(angular.extend({\r\n\t\t\t\tvalue: format.substring(pos)\r\n\t\t\t}, definedTokens.string));\r\n\t\t}\r\n\t\t\r\n\t\treturn tokens;\r\n\t}\r\n\r\n\tfunction getWeek(date) {\r\n\t\tvar yearStart = new Date(date.getFullYear(), 0, 1);\r\n\r\n\t\tvar weekStart = new Date(yearStart.getTime());\r\n\r\n\t\tif (weekStart.getDay() > 4) {\r\n\t\t\tweekStart.setDate(weekStart.getDate() + (1 - weekStart.getDay()) + 7);\r\n\t\t} else {\r\n\t\t\tweekStart.setDate(weekStart.getDate() + (1 - weekStart.getDay()));\r\n\t\t}\r\n\t\tvar diff = date.getTime() - weekStart.getTime();\r\n\r\n\t\treturn Math.floor(diff / (7 * 24 * 60 * 60 * 1000));\r\n\t}\r\n\r\n\t// set the proper date value matching the weekday\r\n\tfunction setDay(date, day) {\r\n\t\t// we don't want to change month when changing date\r\n\t\tvar month = date.getMonth(),\r\n\t\t\tdiff = day - (date.getDay() || 7);\r\n\t\t// move to correct date\r\n\t\tdate.setDate(date.getDate() + diff);\r\n\t\t// check month\r\n\t\tif (date.getMonth() != month) {\r\n\t\t\tif (diff > 0) {\r\n\t\t\t\tdate.setDate(date.getDate() - 7);\r\n\t\t\t} else {\r\n\t\t\t\tdate.setDate(date.getDate() + 7);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setHour12(date, hour) {\r\n\t\thour = hour % 12;\r\n\t\tif (date.getHours() >= 12) {\r\n\t\t\thour += 12;\r\n\t\t}\r\n\t\tdate.setHours(hour);\r\n\t}\r\n\r\n\tfunction setAmpm(date, ampm) {\r\n\t\tvar hour = date.getHours();\r\n\t\tif ((hour < 12) == (ampm > 1)) {\r\n\t\t\tdate.setHours((hour + 12) % 24);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction insertColon(timezone) {\r\n\t\tif (timezone[3] == \":\") {\r\n\t\t\treturn timezone;\r\n\t\t}\r\n\t\treturn timezone.substr(0, 3) + \":\" + timezone.substr(3, 2);\r\n\t}\r\n\t\r\n\tfunction removeColon(timezone) {\r\n\t\tif (timezone[3] != \":\") {\r\n\t\t\treturn timezone;\r\n\t\t}\r\n\t\treturn timezone.substr(0, 3) + timezone.substr(4, 2);\r\n\t}\r\n\t\r\n\tfunction offset(date, timezone) {\r\n\t\ttimezone = removeColon(timezone);\r\n\t\tvar hour = +timezone.substr(1, 2),\r\n\t\t\tmin = +timezone.substr(3, 2),\r\n\t\t\tsig = (timezone[0] + \"1\"),\r\n\t\t\toffset = (hour * 60 + min) * sig;\r\n\t\t\t\r\n\t\treturn new Date(date.getTime() + (offset - -date.getTimezoneOffset()) * 60 * 1000);\r\n\t}\r\n\t\r\n\tfunction deoffset(date, timezone) {\r\n\t\ttimezone = removeColon(timezone);\r\n\t\tvar hour = +timezone.substr(1, 2),\r\n\t\t\tmin = +timezone.substr(3, 2),\r\n\t\t\tsig = (timezone[0] + \"1\"),\r\n\t\t\toffset = (hour * 60 + min) * sig;\r\n\t\t\r\n\t\treturn new Date(date.getTime() + (-date.getTimezoneOffset() - offset) * 60 * 1000);\r\n\t}\r\n\t\r\n\tclass DatetimeParser {\r\n\t\t// Apply timezone offset\r\n\t\tconstructor(tp) {\r\n\t\t\tthis.tp = tp;\r\n\t\t\tthis.timezone = SYS_TIMEZONE;\r\n\t\t\tthis.timezoneNodes = this.tp.nodes.filter(n => n.token.name == \"timezone\");\r\n\t\t}\r\n\t\tparse(text) {\r\n\t\t\tthis.tp.parse(text);\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tgetText() {\r\n\t\t\treturn this.tp.getText();\r\n\t\t}\r\n\t\tsetDate(date, ignoreEmpty) {\r\n\t\t\tthis.tp.setValue(offset(date, this.timezone), ignoreEmpty);\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tgetDate() {\r\n\t\t\treturn deoffset(this.tp.getValue(), this.timezone);\r\n\t\t}\r\n\t\tsetTimezone(timezone = SYS_TIMEZONE) {\r\n\t\t\tif (timezone == this.timezone) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar date = this.getDate();\r\n\t\t\tthis.timezone = timezone;\r\n\t\t\tfor (var n of this.timezoneNodes) {\r\n\t\t\t\tif (n.token.colon) {\r\n\t\t\t\t\tn.token.value = insertColon(timezone);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tn.token.value = removeColon(timezone);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this.setDate(date, false);\r\n\t\t}\r\n\t\tisEmpty() {\r\n\t\t\treturn this.tp.isEmpty.apply(this.tp, arguments);\r\n\t\t}\r\n\t\tisInit() {\t\t\t\r\n\t\t\treturn this.tp.isInit.apply(this.tp, arguments);\r\n\t\t}\r\n\t\tunset() {\r\n\t\t\tthis.tp.unset();\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction createParser(format) {\r\n\t\tvar tokens = createTokens(formats[format] || format),\r\n\t\t\tyearCheck;\r\n\t\t\t\r\n\t\tif (tokens.some(t => t.name == \"yearShort\")) {\r\n\t\t\tyearCheck = function(fn) {\r\n\t\t\t\treturn function(d) {\r\n\t\t\t\t\tfn.apply(this, arguments);\r\n\t\t\t\t\tvar y = d.getFullYear();\r\n\t\t\t\t\tif (y < 0) {\r\n\t\t\t\t\t\td.setFullYear(y + 100);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tyearCheck = function(fn) {\r\n\t\t\t\treturn function(d) {\r\n\t\t\t\t\tfn.apply(this, arguments);\r\n\t\t\t\t\tvar y = d.getFullYear();\r\n\t\t\t\t\tif (y < 0) {\r\n\t\t\t\t\t\td.setFullYear(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (y > 9999) {\r\n\t\t\t\t\t\td.setFullYear(9999);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\tfor (var tk of tokens) {\r\n\t\t\tif (tk.add) {\r\n\t\t\t\ttk.add = yearCheck(tk.add);\r\n\t\t\t}\r\n\t\t\tif (tk.restore) {\r\n\t\t\t\ttk.restore = yearCheck(tk.restore);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar tp = new TextParser({\r\n\t\t\ttokens: tokens,\r\n\t\t\tvalue: new Date,\r\n\t\t\tcopyValue: o => new Date(o.getTime())\r\n\t\t});\r\n\t\t\r\n\t\treturn new DatetimeParser(tp);\r\n\t}\r\n\r\n\treturn createParser;\r\n}\r\n","var angular = require(\"angular\"),\r\n\t{InputMask} = require(\"custom-input\");\r\n\r\nangular.module(\"datetime\").directive(\"datetime\", init);\r\ninit.$inject = [\"datetime\", \"$log\", \"$document\"];\r\nfunction init(datetime, $log, $document){\r\n\tclass Element {\r\n\t\tconstructor(element, document) {\r\n\t\t\tthis.el = element;\r\n\t\t\tthis.doc = document;\r\n\t\t}\r\n\t\ton(eventType, callback) {\r\n\t\t\t// use ngModel.parser to execute digest\r\n\t\t\tif (eventType == \"input\") return;\r\n\r\n\t\t\treturn this.el.on(eventType, callback);\r\n\t\t}\r\n\t\tgetSelection() {\r\n\t\t\tvar el = this.el[0],\r\n\t\t\t\tdoc = this.doc;\r\n\r\n\t\t\tif (doc.activeElement != el) return;\r\n\r\n\t\t\tvar start = el.selectionStart,\r\n\t\t\t\tend = el.selectionEnd;\r\n\r\n\t\t\tif (angular.isDefined(start) && angular.isDefined(end)) {\r\n\t\t\t\treturn { start, end };\r\n\t\t\t}\r\n\t\t\treturn this.getSelectionIE();\r\n\t\t}\r\n\t\tgetSelectionIE() {\r\n\t\t\tvar el = this.el[0],\r\n\t\t\t\tdoc = this.doc;\r\n\r\n\t\t\tvar bookmark = doc.selection.createRange().getBookmark(),\r\n\t\t\t\trange = el.createTextRange(),\r\n\t\t\t\trange2 = range.duplicate();\r\n\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t\trange2.setEndPoint(\"EndToStart\", range);\r\n\r\n\t\t\tvar start = range2.text.length,\r\n\t\t\t\tend = start + range.text.length;\r\n\r\n\t\t\treturn { start, end };\r\n\t\t}\r\n\t\tsetSelection(start, end) {\r\n\t\t\tvar el = this.el[0],\r\n\t\t\t\tdoc = this.doc;\r\n\r\n\t\t\tif (doc.activeElement != el) return;\r\n\t\t\t\r\n\t\t\tif (el.setSelectionRange) {\r\n\t\t\t\tel.setSelectionRange(start, end);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSelectionIE(start, end);\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetSelectionIE(start, end) {\r\n\t\t\tvar el = this.el[0],\r\n\t\t\t\tselect = el.createTextRange();\r\n\r\n\t\t\tselect.moveStart(\"character\", start);\r\n\t\t\tselect.collapse();\r\n\t\t\tselect.moveEnd(\"character\", end - start);\r\n\t\t\tselect.select();\r\n\t\t}\r\n\t\tval(...args) {\r\n\t\t\treturn this.el.val(...args);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction linkFunc(scope, element, attrs, ngModel) {\r\n\r\n\t\tif (!ngModel) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tattrs.ngTrim = \"false\";\r\n\r\n\t\tvar parser = datetime(attrs.datetime),\r\n\t\t\tmodelParser = attrs.datetimeModel && datetime(attrs.datetimeModel),\r\n\t\t\tmaskElement = new Element(element, $document[0]),\r\n\t\t\tmask = new InputMask(maskElement, parser.tp, attrs.datetimeSeparator),\r\n\t\t\tisUtc;\r\n\r\n\t\tmask.on(\"digest\", err => {\r\n\t\t\tif (err.code != \"NOT_INIT\") {\r\n\t\t\t\tngModel.$setValidity(\"datetime\", false);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tparser.tp.on(\"change\", () => {\r\n\t\t\tscope.$evalAsync(() => {\r\n\t\t\t\tif (mask.err) {\r\n\t\t\t\t\tngModel.$setValidity(\"datetime\", false);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (parser.isInit() || parser.isEmpty()) {\r\n\t\t\t\t\tngModel.$setValidity(\"datetime\", true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tngModel.$setValidity(\"datetime\", false);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (parser.getText() != ngModel.$viewValue) {\r\n\t\t\t\t\tngModel.$setViewValue(parser.getText());\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tfunction setUtc(val) {\r\n\t\t\tif (val && !isUtc) {\r\n\t\t\t\tisUtc = true;\r\n\t\t\t\tparser.setTimezone(\"+0000\");\r\n\t\t\t\tif (modelParser) {\r\n\t\t\t\t\tmodelParser.setTimezone(\"+0000\");\r\n\t\t\t\t}\r\n\t\t\t} else if (!val && isUtc) {\r\n\t\t\t\tisUtc = false;\r\n\t\t\t\tparser.setTimezone();\r\n\t\t\t\tif (modelParser) {\r\n\t\t\t\t\tmodelParser.setTimezone();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction setTimezone(val) {\r\n\t\t\tparser.setTimezone(val);\r\n\t\t\tif (modelParser) {\r\n\t\t\t\tmodelParser.setTimezone(val);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (angular.isDefined(attrs.datetimeUtc)) {\r\n\t\t\tif (attrs.datetimeUtc.length > 0) {\r\n\t\t\t\tscope.$watch(attrs.datetimeUtc, setUtc);\r\n\t\t\t} else {\r\n\t\t\t\tsetUtc(true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (angular.isDefined(attrs.datetimeTimezone)) {\r\n\t\t\tif (/^[+-]\\d{2}:?\\d{2}$/.test(attrs.datetimeTimezone)) {\r\n\t\t\t\tsetTimezone(attrs.datetimeTimezone);\r\n\t\t\t} else {\r\n\t\t\t\tscope.$watch(attrs.datetimeTimezone, setTimezone);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction validMin(value) {\r\n\t\t\tif (ngModel.$isEmpty(value) || ngModel.$isEmpty(attrs.min)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (!angular.isDate(value)) {\r\n\t\t\t\tvalue = modelParser.getDate();\r\n\t\t\t}\r\n\t\t\treturn value >= new Date(attrs.min);\r\n\t\t}\r\n\r\n\t\tfunction validMax(value) {\r\n\t\t\tif (ngModel.$isEmpty(value) || ngModel.$isEmpty(attrs.max)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (!angular.isDate(value)) {\r\n\t\t\t\tvalue = modelParser.getDate();\r\n\t\t\t}\r\n\t\t\treturn value <= new Date(attrs.max);\r\n\t\t}\r\n\r\n\t\tif (ngModel.$validators) {\r\n\t\t\tngModel.$validators.min = validMin;\r\n\t\t\tngModel.$validators.max = validMax;\r\n\t\t}\r\n\r\n\t\tattrs.$observe(\"min\", function(){\r\n\t\t\tvalidMinMax(parser.getDate());\r\n\t\t});\r\n\r\n\t\tattrs.$observe(\"max\", function(){\r\n\t\t\tvalidMinMax(parser.getDate());\r\n\t\t});\r\n\r\n\t\tngModel.$render = function(){\r\n\t\t\t// let mask do render stuff?\r\n\t\t\t// element.val(ngModel.$viewValue || \"\");\r\n\t\t};\r\n\r\n\t\tngModel.$isEmpty = function(value) {\r\n\t\t\tif (!value) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (typeof value == \"string\") {\r\n\t\t\t\treturn parser.isEmpty(value);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\tfunction validMinMax(date) {\r\n\t\t\tif (ngModel.$validate) {\r\n\t\t\t\tngModel.$validate();\r\n\t\t\t} else {\r\n\t\t\t\tngModel.$setValidity(\"min\", validMin(date));\r\n\t\t\t\tngModel.$setValidity(\"max\", validMax(date));\r\n\t\t\t}\r\n\t\t\treturn !ngModel.$error.min && !ngModel.$error.max;\r\n\t\t}\r\n\r\n\t\tngModel.$parsers.unshift(function(viewValue){\r\n\t\t\t// You will get undefined when input is required and model get unset\r\n\t\t\tif (angular.isUndefined(viewValue)) {\r\n\t\t\t\tviewValue = parser.getText();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!angular.isString(viewValue)) {\r\n\t\t\t\t// let unknown value pass through\r\n\t\t\t\treturn viewValue;\r\n\t\t\t}\r\n\r\n\t\t\tmask.digest(null, viewValue);\r\n\r\n\t\t\tif (!parser.isInit()) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\r\n\t\t\tvar date = parser.getDate();\r\n\r\n\t\t\tif (ngModel.$validate || validMinMax(date)) {\r\n\t\t\t\tif (modelParser) {\r\n\t\t\t\t\treturn modelParser.setDate(date).getText();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Create new date to make Angular notice the difference.\r\n\t\t\t\t\treturn new Date(date.getTime());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\t\t});\r\n\t\t\r\n\t\tfunction validModelType(model) {\r\n\t\t\tif (angular.isDate(model) && !modelParser) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (angular.isString(model) && modelParser) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tngModel.$formatters.push(function(modelValue){\r\n\t\t\t\r\n\t\t\t// formatter clean the error\r\n\t\t\tngModel.$setValidity(\"datetime\", true);\r\n\t\t\t\r\n\t\t\t// handle empty value\r\n\t\t\tif (!modelValue) {\r\n\t\t\t\tparser.unset();\r\n\t\t\t\t// FIXME: input will be cleared if modelValue is empty and the input is required. This is a temporary fix.\r\n\t\t\t\tscope.$evalAsync(() => {\r\n\t\t\t\t\tngModel.$setViewValue(parser.getText());\r\n\t\t\t\t});\r\n\t\t\t\treturn parser.getText();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// let unknown model type pass through\r\n\t\t\tif (!validModelType(modelValue)) {\r\n\t\t\t\treturn modelValue;\r\n\t\t\t}\r\n\r\n\t\t\tif (modelParser) {\r\n\t\t\t\tmodelValue = modelParser.parse(modelValue).getDate();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!ngModel.$validate) {\r\n\t\t\t\tvalidMinMax(modelValue);\r\n\t\t\t}\r\n\r\n\t\t\treturn parser.setDate(modelValue).getText();\r\n\t\t});\r\n\t}\r\n\r\n\treturn {\r\n\t\trestrict: \"A\",\r\n\t\trequire: \"?ngModel\",\r\n\t\tlink: linkFunc,\r\n\t\tpriority: 100\r\n\t};\r\n}\r\n"],"names":["angular","constant","year","yearShort","month","date","day","hour","hour12","minute","second","millisecond","ampm","week","EventLite","_module_","exports","LISTENERS","methods","on","once","off","emit","mixin","prototype","target","key","type","func","getListeners","push","that","wrap","originalListener","call","apply","arguments","listners","length","Object","keys","filter","ne","test","value","listeners","arglen","forEach","zeroarg","onearg","args","Array","slice","moreargs","readonly","num","minLength","maxLength","i","substr","getMatch","str","pos","pattern","strQ","toUpperCase","patternQ","getInteger","substring","match","parseNode","text","token","result","parseToken","err","startsWith","placeholder","viewValue","empty","m","j","code","message","properValue","num2str","min","max","select","selected","parseNodes","nodes","node","r","last","formatNode","v","extract","formatNodes","ignoreEmpty","Node","parser","offset","next","prev","nextEdit","prevEdit","unset","noEmpty","setValue","parse","restoreValue","copyValue","add","diff","nodeValue","addValue","o","tk","p","restore","createNodes","tokens","edit","nocopy","createNameMap","map","Map","l","get","name","set","TextParser","_constructor","initialize","Error","nameMap","oldText","changed","comparer","empties","errors","sort","a","b","prior","c","newText","join","properText","isEmpty","isInit","getText","getValue","getNodes","Emitter","findNearestNode","matchNodes","left","right","start","end","first","Selection","element","el","range","selectNearestNode","getSelection","assign","setSelection","hasNext","hasPrev","selectNext","selectPrev","atNodeEnd","len","atNodeStart","InputMask","textParser","separators","tp","sel","n","mousedown","setTimeout","digest","val","e","altKey","ctrlKey","keyCode","shiftKey","preventDefault","tryFixingError","charCode","String","fromCharCode","includes","inDigest","errorViewLength","undefined","fixErr","_require__$lib$text_parser_","_require__$lib$input_mask_","_require_angular_","_require_custom_input_","_require_custom_input$lib$utils_","module","factory","init","$inject","$locale","datetimePlaceholder","formats","DATETIME_FORMATS","tokenRE","definedTokens","MONTH","SHORTMONTH","fixDay","DAY","SHORTDAY","AMPMS","colon","nameConf","d","getFullYear","setFullYear","getMonth","setMonth","setDate","getDate","oldMonth","monthNodes","every","getDay","setDay","getHours","setHours","setHour12","setAmpm","getMinutes","setMinutes","getSeconds","setSeconds","getMilliseconds","setMilliseconds","getWeek","values","extend","SYS_TIMEZONE","Date","getTimezoneOffset","sign","absOffset","Math","abs","floor","days","s","createTokens","format","exec","index","string","sss","replace","tz","insertColon","lastIndex","yearStart","weekStart","getTime","timezone","removeColon","sig","deoffset","DatetimeParser","timezoneNodes","setTimezone","createParser","yearCheck","some","t","fn","y","directive","datetime","$log","$document","Element","document","doc","eventType","callback","activeElement","selectionStart","selectionEnd","isDefined","getSelectionIE","bookmark","selection","createRange","getBookmark","createTextRange","range2","duplicate","moveToBookmark","setEndPoint","setSelectionRange","setSelectionIE","moveStart","collapse","moveEnd","linkFunc","scope","attrs","ngModel","ngTrim","modelParser","datetimeModel","maskElement","mask","datetimeSeparator","isUtc","$setValidity","$evalAsync","$viewValue","$setViewValue","setUtc","datetimeUtc","$watch","datetimeTimezone","validMin","$isEmpty","isDate","validMax","$validators","$observe","validMinMax","$render","$validate","$error","$parsers","unshift","isUndefined","isString","validModelType","model","$formatters","modelValue","restrict","require","link","priority"],"mappings":"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"}